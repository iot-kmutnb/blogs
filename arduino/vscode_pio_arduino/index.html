<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="RSP">
        <link rel="canonical" href="http://iot-kmutnb.github.com/blogs/arduino/vscode_pio_arduino/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>VS Code IDE + PlatformIO Extension for Arduino Programming - IoT Engineering Education</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
        <link href="../../css/extra.css" rel="stylesheet">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/c.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/cpp.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/c++.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/arduino.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/javascript.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/typescript.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/json.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/rust.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/vhdl.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/verilog.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/bash.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/matlab.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/julia.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">IoT Engineering Education</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="../../about/" class="nav-link">About</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#vs-code-ide-platformio-extension-for-arduino-programming" class="nav-link">VS Code IDE + PlatformIO Extension for Arduino Programming</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#platformio" class="nav-link">&#9655; ซอฟต์แวร์และการบริการของ PlatformIO</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#platformio_1" class="nav-link">&#9655; จุดเด่นของ PlatformIO</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#platformio-vs-code" class="nav-link">&#9655; การติดตั้งและใช้งาน PlatformIO สำหรับ VS Code</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#arduino" class="nav-link">&#9655; ตัวอย่างการสร้างโปรเจกต์สำหรับ Arduino</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#arduino_1" class="nav-link">&#9655; ตัวอย่างการติดตั้งไลบรารีสำหรับ Arduino</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_1" class="nav-link">&#9655; กล่าวสรุป</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="vs-code-ide-platformio-extension-for-arduino-programming">VS Code IDE + PlatformIO Extension for Arduino Programming<a class="headerlink" href="#vs-code-ide-platformio-extension-for-arduino-programming" title="Permanent link">#</a></h1>
<p><strong>Keywords</strong>: <em>VS Code</em>, <em>PlatformIO</em>, <em>PIO</em>, <em>Arduino Programming</em></p>
<hr />
<h2 id="platformio">&#9655; <strong>ซอฟต์แวร์และการบริการของ PlatformIO</strong><a class="headerlink" href="#platformio" title="Permanent link">#</a></h2>
<p><a href="https://platformio.org"><strong>PlatformIO (PIO)</strong></a> เป็นซอฟต์แวร์ประเภท <strong>Open Source</strong>
และใช้ในการพัฒนาเฟิร์มแวร์ด้วยภาษา <strong>C/C++</strong> สำหรับไมโครคอนโทรลเลอร์หลายแบบหลายตระกูล 
(โดยรวมแล้ว ในปัจจุบันมีบอร์ดมากกว่า 1000 รายการ ให้เลือกใช้งานได้) </p>
<p>บริษัทผู้พัฒนา <strong>PIO</strong> คือ <a href="https://piolabs.com/company/about.html"><strong>PlatformIO Labs OÜ</strong></a>
มีผู้ก่อตั้งและ <strong>CEO</strong> คือ <a href="https://ua.linkedin.com/in/ivankravets"><strong>Ivan Kravets</strong></a>
หลังจากที่เขาได้เรียนจบปริญญาเอกทางด้านวิศวกรรมคอมพิวเตอร์ ก็ได้เปิดบริษัทและให้บริการซอฟต์แวร์ <strong>PlatformIO</strong>
แบบใช้งานได้ฟรีมาตั้งแต่ปีค.ศ. 2014 เป็นต้นมา และมีทีมงาน <strong>R&amp;D</strong> ของบริษัทอยู่ในประเทศยูเครน (<strong>Ukraine</strong>)</p>
<p>ซอฟต์แวร์และการบริการของ <strong>PIO</strong> อาจแบ่งได้ดังนี้</p>
<ul>
<li><strong>PlatformIO Core &amp; IDE</strong>: เป็น <strong>Open Source (Apache License)</strong>
 เริ่มใช้งานมาตั้งแต่ปีค.ศ. 2014 มีการพัฒนาอย่างต่อเนื่อง <ul>
<li><a href="https://github.com/platformio/platformio-core"><strong>PlatformIO Core (CLI)</strong></a>:
เป็นซอฟต์แวร์ที่เขียนด้วยภาษา <strong>Python</strong> ทั้งหมด 
และทำงานแบบ <strong>Command line (CLI)</strong>: ประกอบด้วยกลุ่มคำสั่งต่าง ๆ เป็นโปรแกรมที่เขียนด้วย <strong>Python</strong> และถือว่าเป็นแกนกลางของ <strong>PlatformIO</strong></li>
<li><a href="https://docs.platformio.org/en/latest/home/index.html"><strong>PlatformIO Home</strong></a>: ทำหน้าที่เป็น <strong>Web-based User Interface (UI)</strong> สำหรับผู้ใช้ เช่น การจัดการโปรเจกต์ การจัดการบอร์ดหรือแพลตฟอร์มที่เลือกใช้ การจัดการไลบรารี  เป็นต้น และทำงานเป็นส่วนหนึ่งของ  <strong>PlatformIO IDE</strong></li>
</ul>
</li>
<li><strong>PlatformIO IDE</strong>:   เป็น <strong>Extension / Plugin</strong> สำหรับติดตั้งเพิ่มสำหรับ <strong>IDE</strong> ต่าง ๆ 
ที่ได้รับความนิยมในปัจจุบัน มีทั้งแบบ  <strong>Desktop IDE</strong> และ <strong>Cloud IDE</strong> เช่น<ul>
<li><strong>Atom</strong></li>
<li><strong>CLion</strong></li>
<li><strong>CodeBlocks</strong></li>
<li><strong>Eclipse</strong></li>
<li><strong>NetBeans</strong> </li>
<li><strong>Qt Creator</strong></li>
<li><strong>Sublime Text</strong></li>
<li><strong>Visual Studio</strong></li>
<li><strong>Cloud9</strong></li>
<li><strong>Eclipse Che</strong></li>
</ul>
</li>
<li>ตัวอย่างของ <strong>PIO Plugins</strong> เช่น <ul>
<li><a href="https://github.com/platformio/platformio-atom-ide"><strong>"PlatformIO IDE for Atom"</strong></a> สำหรับ <a href="https://atom.io/"><strong>Atom IDE</strong></a> ซึ่งได้เริ่มพัฒนาและใช้งานมาตั้งแต่ปีค.ศ. 2016</li>
<li><a href="https://github.com/platformio/platformio-vscode-ide"><strong>"PlatformIO IDE for VSCode"</strong></a> สำหรับ <a href="https://code.visualstudio.com/"><strong>VS Code</strong></a>
เริ่มมีการพัฒนาและใช้งานมาตั้งแต่ปีค.ศ. 2017 (First Release: 5/28/2017) และน่าจะเป็นตัวเลือกที่ได้รับความนิยมมากที่สุดในปัจจุบัน</li>
</ul>
</li>
<li><strong>PlatformIO Plus</strong>:<ul>
<li>บริการนี้ไม่ฟรี แต่ทางบริษัทเปลี่ยนแผนธุรกิจใหม่ เพราะได้เงินทุนสนับสนุนเพิ่ม และทำให้ซอฟต์แวร์ในส่วนนี้กลายเป็น
<strong>Open Source</strong> ในเดือนมิถุนายน ค.ศ. 2019 </li>
<li>องค์ประกอบซอฟต์แวร์และการบริการที่เกี่ยวข้อง คือ<ul>
<li><strong>PIO Unified Debugger</strong>:
ทำให้ผู้ใช้สามารถตรวจสอบการทำงานของโค้ดโดยใช้บอร์ดทดลองหรือฮาร์ดแวร์จริงได้ (<strong>In-circuit debugging</strong>)</li>
<li><strong>PIO Unit Testing Engine</strong>:
เกี่ยวข้องกับขั้นตอนในการทดสอบซอฟต์แวร์</li>
<li><strong>PIO Remote</strong>:
เป็นส่วนหนึ่งของ <strong>PlatformIO Remote Development Solution</strong> 
ที่เปิดให้บริการมาตั้งแค่ปีค.ศ. 2016 (แต่ในช่วงเวลานั้นจนถึงปีค.ศ. 2019 ยังไม่ฟรี ต้องสมัครสมาชิกและมีค่าใช้จ่าย)
ทำให้ผู้ใช้สามารถเข้าถึงบอร์ดทดลองหรือฮาร์ดแวร์ที่อยู่ไกลออกไป ใช้งานผ่านระบบเครือข่ายหรืออินเทอร์เน็ตได้ 
โดยติดตั้งใช้งานซอฟต์แวร์ที่เรียกว่า <strong>PIO Remote Agent</strong> 
และเชื่อมต่อไปยัง <strong>PIO Broker</strong> ในระบบ <strong>PlatformIO Cloud</strong> 
ผู้ใช้สามารถแชร์ทรัพยากรฮาร์ดแวร์ระหว่างทีมพัฒนาได้ และใช้งานผ่าน <strong>Cloud IDE</strong>
เช่น <a href="https://c9.io/"><strong>Cloud9</strong></a> ได้ฟรี</li>
</ul>
</li>
</ul>
</li>
<li><strong>Commercial subscriptions: PlatformIO Premium</strong>:<ul>
<li>บริการส่วนนี้ มีค่าใช้จ่าย เหมาะสำหรับบุคคลหรือบริษัทที่ต้องการ <strong>Support</strong> จากทางบริษัท </li>
</ul>
</li>
</ul>
<hr />
<h2 id="platformio_1">&#9655; <strong>จุดเด่นของ PlatformIO</strong><a class="headerlink" href="#platformio_1" title="Permanent link">#</a></h2>
<p>ข้อดีของการใช้งาน <strong>PlatformIO</strong> ได้แก่</p>
<ul>
<li>ทำหน้าที่เป็น <strong>"Multi-platform Build System"</strong> เพื่อใช้ในการสร้างโปรเจกต์และคอมไพล์โค้ดสำหรับบอร์ดไมโครคอนโทรลเลอร์</li>
<li>สามารถทำงานร่วมกับ <strong>IDE</strong> ได้หลายตัวเลือก โดยจะต้องติดตั้ง <strong>Plugin / Extension</strong> ที่เกี่ยวข้องเพิ่ม</li>
<li>มี <strong>Software Frameworks</strong> หลายแบบให้เลือกใช้งาน เช่น ผู้ใช้สามารถเขียนโค้ดด้วย <strong>Arduino framework</strong> ได้</li>
<li>มีการติดตั้งซอฟต์แวร์และโปรแกรมต่าง ๆ ที่เกี่ยวข้องกับบอร์ดไมโครคอนโทรลเลอร์ที่เลือกใช้งานได้โดยอัตโนมัติ เช่น <strong>Toolchains</strong> </li>
<li>รองรับการดีบักโค้ดในฮาร์ดแวร์ (<a href="https://docs.platformio.org/en/latest/plus/debugging.html"><strong>In-Circuit Debugger</strong></a>) 
และรองรับอุปกรณ์ประเภท <strong>Debug Probe</strong> ได้หลายแบบ
 เช่น <strong>CMSIS-DAP / DAPLink</strong>, <strong>ST-Link/V2</strong>, <strong>SEGGER J-Link</strong>, 
<strong>Black Magic Probe</strong>, <strong>Atmel-ICE</strong> เป็นต้น โดยใช้งานซอฟต์แวร์ <strong>OpenOCD / PyOCD</strong>
เป็นตัวกลางเพื่อเชื่อมต่อกับฮาร์ดวแร์ดังกล่าว</li>
<li>ใช้งานแบบรีโมทและในระบบ <strong>Cloud</strong> ได้</li>
<li>สามารถกำหนดค่าต่าง ๆ ในการใช้งานสำหรับโปรเจกต์ได้ในไฟล์ <code>platformio.ini</code> (<em>Project Configuration File</em>)</li>
</ul>
<p>หากเลือกใช้ไมโครคอนโทรลเลอร์ตระกูล <strong>STM32</strong> ก็มีตัวเลือกดังนี้สำหรับเขียนโค้ดดังนี้</p>
<ul>
<li><strong>Low-level (Drivers, Libraries)</strong><ul>
<li><a href="https://github.com/ARM-software/CMSIS_5">Arm CMSIS 5</a></li>
<li><a href="https://www.st.com/en/ecosystems/stm32cube.html">STM32Cube HAL</a></li>
<li><a href="https://libopencm3.org/">libOpenCM3</a></li>
<li><a href="https://github.com/espressif/esp-idf">Espressif ESP-IDF</a></li>
</ul>
</li>
<li><strong>High-level (Framworks / Software Development Kits (SDKs)</strong> <ul>
<li><a href="https://www.arduino.cc/">Arduino</a> (based on <a href="https://github.com/stm32duino">STM32Duino</a>)</li>
<li><a href="https://github.com/ARMmbed/mbed-os">Arm Mbed OS</a></li>
<li><a href="https://zephyrproject.org/">Zephyr RTOS</a></li>
</ul>
</li>
</ul>
<hr />
<h2 id="platformio-vs-code">&#9655; <strong>การติดตั้งและใช้งาน PlatformIO สำหรับ VS Code</strong><a class="headerlink" href="#platformio-vs-code" title="Permanent link">#</a></h2>
<p>ถ้าเคยใช้ <strong>Microsoft VS Code</strong> เป็น <strong>IDE</strong> มาบ้างแล้ว ก็สามารถติดตั้ง 
<a href="https://marketplace.visualstudio.com/items?itemName=platformio.platformio-ide"><strong>PIO Extension</strong></a> เพิ่มได้ไม่ยาก
แต่ถ้าไม่เคยติดตั้งใช้งาน  <strong>VS Code</strong> ก็ให้เปิดเบราว์เซอร์ไปที่ <strong>URL</strong> ต่อไปนี้ 
แล้วเลือกดาวน์โหลดไฟล์สำหรับการติดตั้งใช้งาน</p>
<ul>
<li><a href="https://code.visualstudio.com/download">https://code.visualstudio.com/download</a> </li>
</ul>
<p>เมื่อได้ติดตั้งและเปิดใช้งาน <strong>VS Code</strong> ได้แล้ว ให้ไปที่ <strong>Tab Extension</strong> 
สำหรับ <strong>VSCode Extension Manager</strong>
ซึ่งอยู่ทางซ้ายมือ  แล้วพิมพ์ค้นหา <strong>Extension</strong>
โดยระบุชื่อเป็น <code>"PlatformIO IDE"</code> เมื่อพบรายการตัวเลือกดังกล่าว
ก็ให้กดปุ่ม  <strong>Install</strong> เพื่อทำขั้นตอนติดตั้ง</p>
<p>&nbsp;</p>
<p><img alt="" src="../images/pio_extension_for_vscode.png" /></p>
<p>รูป: PlatformIO IDE for VS Code</p>
<p>&nbsp;</p>
<p><img alt="" src="../images/vscode_pio-1.png" /></p>
<p>รูป: ค้นหา <strong>Extension</strong> ที่ต้องการติดตั้งเพิ่มใน <strong>VS Code</strong></p>
<p>&nbsp;</p>
<p><img alt="" src="../images/vscode_pio-2.png" /></p>
<p>รูป: ทำขั้นตอนติดตั้ง <strong>PIO Extension</strong></p>
<p>&nbsp;</p>
<p><img alt="" src="../images/vscode_pio-3.png" /></p>
<p>รูป: เมื่อได้ติดตั้ง <strong>PIO Extension</strong> แล้ว ให้เปิดใช้งาน <strong>PIO Home</strong> โดยคลิกสัญลักษณ์ของ <strong>PIO</strong>
ที่อยู่ในแถบแนวตั้งทางซ้ายมือ</p>
<p>&nbsp;</p>
<p>ในหน้าต่าง <strong>PIO Home</strong> จะเห็นว่า ในส่วนที่เรียกว่า <strong>Quick Access</strong> 
ผู้ใช้สามารถสร้างโปรเจกต์ใหม่ (<strong>+ New Project</strong>) หรือนำเข้าโปรเจกต์ของ 
<strong>Arduino Sketch</strong> (<strong>Import Arduino Project</strong>) 
หรือเปิดใช้งานโปรเจกต์ที่ได้เคยสร้างไว้แล้ว (<strong>Open Project</strong>) </p>
<p><img alt="" src="../images/vscode_pio-5.png" /></p>
<p>รูป: การสร้างโปรเจกต์ใหม่ ในหน้าต่างของ <strong>Project Wizard</strong></p>
<p>&nbsp;</p>
<hr />
<h2 id="arduino">&#9655; <strong>ตัวอย่างการสร้างโปรเจกต์สำหรับ Arduino</strong><a class="headerlink" href="#arduino" title="Permanent link">#</a></h2>
<p>ถัดไปเป็นการสาธิตขั้นตอนการสร้างโปรเจกต์ใหม่ โดยเลือกใช้บอร์ด <strong>Arduino</strong> 
เช่น <strong>Arduino Nano (328P)</strong> และลองเขียนโค้ดตัวอย่าง
ทำขั้นตอน <strong>Build</strong> และ <strong>Upload</strong> ไปยังอุปกรณ์ฮาร์ดแวร์จริง</p>
<p>ขั้นตอนตามลำดับมีดังนี้</p>
<ol>
<li>สร้างโปรเจกต์ใหม่ โดยใช้ <strong>Projecty Wizard</strong> ตั้งชื่อโปรเจกต์ เลือกบอร์ดที่จะใช้งาน และเลือกรูปแบบการเขียนโค้ด
(<strong>Frawework</strong>) ในกรณีตัวอย่างนี้คือ เลือก <strong>Arduino Framework</strong> </li>
<li>เมื่อกดปุ่ม <strong>Finish</strong> จะมีการดาวน์โหลดและติดตั้งโปรแกรมหรือไฟล์ต่าง ๆ ที่เกี่ยวข้องกับการเขียนโค้ดด้วย <strong>Arduino</strong>
มายังเครื่องของผู้ใช้โดยอัตโนมัติ เช่น <strong>avr-gcc toolchain</strong></li>
<li>เปิดไฟล์ <code>main.cpp</code> เพื่อเขียนโค้ด หรือเพิ่มไฟล์สำหรับ <strong>Source Code</strong> ในโปรเจกต์ใหม่</li>
<li>แก้ไขการตั้งค่าใช้งานสำหรับโปรเจกต์ใหม่ในไฟล์ <code>platformio.ini</code> เช่น การตั้งค่า <strong>Baudrate</strong> สำหรับ
<strong>Arduino Serial Monitor</strong> เป็นต้น</li>
<li>ทำขั้นตอน <strong>PlatformIO: Build</strong> เพื่อคอมไพล์โค้ด</li>
<li>เชื่อมต่อบอร์ด <strong>Arduino</strong> กับคอมพิวเตอร์ผู้ใช้ และทำขั้นตอน <strong>PlatformIO: Upload</strong> ไปยังบอร์ด</li>
</ol>
<p>&nbsp;</p>
<p><img alt="" src="../images/pio_arduino_nano-1.png" /></p>
<p>รูป: เริ่มขั้นตอนสร้างโปรเจกต์ใหม่ โดยใช้ <strong>Project Wizard</strong></p>
<p>&nbsp;</p>
<p><img alt="" src="../images/pio_arduino_nano-2.png" /></p>
<p>รูป: ตั้งชื่อโปรเจต์ เลือก <strong>Arduino Nano ATmega328 (New Bootloader)</strong> เป็นตัวอย่างสำหรับ <strong>Platform</strong> 
แล้วเลือก <strong>Arduino</strong> สำหรับ <strong>Framework</strong></p>
<p>&nbsp;</p>
<p><img alt="" src="../images/pio_arduino_nano-3.png" /></p>
<p>รูป: เมื่อกดปุ่ม <strong>Finish</strong> ให้รอการติดตั้งซอฟต์แวร์เพิ่มสำหรับ <strong>Arduino Framework</strong> จนแล้วเสร็จ </p>
<p>&nbsp;</p>
<p><img alt="" src="../images/pio_arduino_nano-4.png" /></p>
<p>รูป: เปิดดูการตั้งค่าต่าง ๆ  ของโปรเจกต์ภายในไฟล์ <code>platformio.ini</code></p>
<p>&nbsp;</p>
<p><img alt="" src="../images/pio_arduino_nano-5.png" /></p>
<p>รูป: เปิดไฟล์ <code>main.cpp</code> และเขียนโค้ด <strong>Arduino Sketch</strong></p>
<p>&nbsp;</p>
<p><img alt="" src="../images/pio_arduino_platformio_ini.png" /></p>
<p>รูป: แก้ไขไฟล์ <code>platformio.ini</code> เพื่อกำหนดค่า <strong>Serial Baudrate</strong> ให้เป็น 115200</p>
<p>&nbsp;</p>
<p><img alt="" src="../images/pio_arduino_nano-6.png" /></p>
<p>รูป: ตัวอย่างโค้ด <strong>Arduino Sketch</strong> (ไฟล์ <code>main.cpp</code>)</p>
<p>&nbsp;</p>
<p><img alt="" src="../images/pio_arduino_nano-7.png" /></p>
<p>รูป:  การทำขั้นตอน <strong>PlatformIO: Build</strong> 
(กดปุ่มสัญลักษณ์เครื่องหมาย &check; ตรงแถบด้านล่างของ <strong>VS Code</strong>)
และตัวอย่างข้อความเอาต์พุตใน <strong>Terminal</strong></p>
<p>&nbsp;</p>
<p><img alt="" src="../images/pio_arduino_nano-8.png" /></p>
<p>รูป:  การทำขั้นตอน <strong>PlatformIO: Upload</strong> 
(กดปุ่มสัญลักษณ์เครื่องหมาย &rarr; ตรงแถบด้านล่างของ <strong>VS Code</strong>)
และตัวอย่างข้อความเอาต์พุตใน <strong>Terminal</strong></p>
<p>&nbsp;</p>
<p><img alt="" src="../images/pio_arduino_nano-9.png" />
<br>รูป: ตัวอย่างข้อความเอาต์พุตใน <strong>Terminal</strong> เพื่อเปิดใช้งาน <strong>Device Monitor</strong>
รับข้อความจากบอร์ด <strong>Arduino Nano</strong> ผ่านทางพอร์ต <strong>Serial</strong></p>
<p>&nbsp;</p>
<hr />
<h2 id="arduino_1">&#9655; <strong>ตัวอย่างการติดตั้งไลบรารีสำหรับ Arduino</strong><a class="headerlink" href="#arduino_1" title="Permanent link">#</a></h2>
<p>รายการไลบรารีที่สามารถเลือกใช้ได้ใน <strong>PIO</strong> มีมากกว่า 10,000 รายการ ดูได้จาก <a href="https://registry.platformio.org/search?t=library"><strong>PlatformIO: Library Registry</strong></a></p>
<p>ถัดไปเป็นตัวอย่างการใช้งานไลบรารีสำหรับ <strong>Arduino</strong> สาธิตการนำเข้าไลบรารี 
<a href="https://github.com/FastLED/FastLED"><code>FastLED</code></a> และนำมาใช้ในการเขียนโค้ด
เพื่อกำหนดสถานะการทำงานของ <strong>WS2812B RGB LEDs (NeoPixels)</strong>
ซึ่งมีจำนวน 8 พิกเซล (มี <strong>WS2812B</strong> จำนวน 8 ดวง)</p>
<p>&nbsp;</p>
<p><img alt="" src="../images/pio_libraries.png" /></p>
<p>รูป: การค้นหา "Libraries" ที่ต้องการใช้งานสำหรับโปรเจกต์</p>
<p>&nbsp;</p>
<p><img alt="" src="../images/pio_lib_fastled-1.png" /></p>
<p>รูป: ผลการค้นหา <code>FastLED</code></p>
<p>&nbsp;</p>
<p><img alt="" src="../images/pio_lib_fastled-2.png" /></p>
<p>รูป: ตัวอย่างการกำหนดค่าใน <code>platformio.ini</code> สำหรับใช้งานไลบรารี <code>FastLED</code></p>
<p>&nbsp;</p>
<p><img alt="" src="../images/pio_lib_fastled-3.png" /></p>
<p>รูป: กำหนดค่าในส่วนที่เรียกว่า <strong>Library Dependencies</strong> (<code>lib_deps</code>)
และระบุเวอร์ชันที่จะใช้งาน (เช่น <code>^3.4.0</code>)</p>
<p>&nbsp;</p>
<p>ข้อสังเกต: รูปแบบการกำหนดเวอร์ชัน (<strong>Release / Version</strong>) 
ของไลบรารีที่ใช้กับ <strong>PIO</strong> เรียกว่า <strong>version Numbering Scheme</strong> หรือ 
<a href="https://semver.org/"><strong>Semantic Versioning (<code>semver</code>)</strong></a> 
แบ่งเป็นสามส่วนด้วยจุด (<strong>dot</strong>) คือ <code>&lt;major&gt;.&lt;minor&gt;.&lt;patch&gt;</code> ตามลำดับ </p>
<ul>
<li><code>major</code>: เมื่อมีการเปลี่ยนแปลง <strong>API</strong> ที่ทำให้โค้ดเดิมอาจใช้เวอร์ชันใหม่นี้ไม่ได้ (<strong>Changes that break backward compatibility</strong>)</li>
<li><code>minor</code>: เมื่อมีการเพิ่มฟังก์ชันในไลบรารีหรือ <strong>API</strong> แต่ยังใช้ <strong>API</strong> ได้เหมือนเดิม (<strong>Backward compatible new features</strong>)</li>
<li><code>patch</code>: เมื่อมีการแก้ไขบัก (<strong>Bug</strong>) และยังใช้ <strong>API</strong> ได้เหมือนเดิม (<strong>Backward compatible bug fixes</strong>)</li>
</ul>
<p>นอกจากนั้นยังสามารถใช้สัญลักษณ์เริ่มต้น (<strong>Prefix Characters</strong>) เช่น </p>
<ul>
<li><strong>caret</strong> (<code>^</code>): new functionality in a backwards compatible manner and patches are allowed</li>
<li><strong>tilde</strong> (<code>~</code>): any version with the same major and minor versions, and an equal or greater patch version</li>
</ul>
<p>ถ้าเขียนว่า <code>~3.4.0</code>  ก็หมายถึง เวอร์ชันที่ต้องมี <strong>Major</strong> และ <strong>Minor version</strong> เดียวกันกับที่ระบุไว้ (3.4.x) 
และมี  <strong>Patch version</strong> เหมือนกันหรือสูงกว่าได้</p>
<p>แต่ถ้าเขียนว่า <code>^3.4.0</code>  ก็หมายถึง เวอร์ชันที่ต้องมี <strong>Major version</strong> เดียวกัน   แต่ <strong>Minor version</strong> และ  <strong>Patch version</strong> เหมือนกันหรือสูงกว่าได้</p>
<p>&nbsp;</p>
<p>ตัวอย่างโค้ดสาธิตการใช้งานไลบรารี <code>FastLED</code> ในเบื้องต้น 
(กำหนดสีของ <strong>LED</strong> ให้เป็นสีแดงทุกดวงแต่ปรับระดับความสว่างตามที่กำหนดไว้ในอาร์เรย์ตามลำดับ)</p>
<pre><code class="language-c++">#include &lt;Arduino.h&gt;
#include &lt;FastLED.h&gt; // include the FastLED library

#define LED_PIN      5   // select D5 pin for WS2812 LED strip
#define NUM_LEDS     8   // 8 pixels 
#define COLOR_ORDER  GRB
#define CHIPSET      WS2812B

CRGB leds[NUM_LEDS];

void setup() {
  FastLED.addLeds&lt;CHIPSET, LED_PIN, COLOR_ORDER&gt;(leds, NUM_LEDS);
  for ( int i=0; i &lt; NUM_LEDS; i++ ) {
     leds[i] = CRGB::Red; // set color to red
  }
}

// brightness levels
uint8_t BRIGHTNESS_LEVELS[] = {0,16,64,128,255};
int level = 0;

void loop() {
  level = (level+1) % sizeof(BRIGHTNESS_LEVELS)/sizeof(uint8_t);
  FastLED.setBrightness( BRIGHTNESS_LEVELS[level] );
  FastLED.show(); // display this frame
  delay(200);
}
</code></pre>
<p>ตัวอย่างไฟล์ <code>platformio.ini</code></p>
<pre><code class="language-json">[env:nanoatmega328new]
platform = atmelavr
board = nanoatmega328new
framework = arduino
monitor_speed = 115200
lib_deps =
  fastled/FastLED @ ^3.4.0
</code></pre>
<p>&nbsp;</p>
<p><img alt="" src="../images/pio_lib_fastled-4.png" /></p>
<p>รูป: การทำขั้นตอน <strong>PlatformIP: Build</strong> ได้สำเร็จโดยปราศจากข้อผิดพลาด</p>
<p>&nbsp;</p>
<p><img alt="" src="../images/arduino_nano_ws2812b_leds.jpg" /></p>
<p>รูป: บอร์ด <strong>Arduino Nano</strong> และโมดูล <strong>WS2812B RGB LED Bar</strong></p>
<p>&nbsp;</p>
<hr />
<h2 id="_1">&#9655; <strong>กล่าวสรุป</strong><a class="headerlink" href="#_1" title="Permanent link">#</a></h2>
<p>การใช้งานซอฟต์แวร์ <strong>PlatformIO (PIO)</strong> ร่วมกับ <strong>VS Code</strong>
เป็นอีกตัวเลือกหนึ่งที่น่าสนใจสำหรับผู้ที่ต้องการเขียนโค้ด <strong>Arduino Sketch</strong>
เพื่อนำไปใช้กับบอร์ดไมโครคอนโทรลเลอร์ <strong>Arduino</strong> ตามที่ได้นำเสนอเป็นตัวอย่างในบทความนี้ 
(แต่การใช้งาน <strong>PIO</strong> ก็ไม่ได้จำกัดอยู่เฉพาะบอร์ด <strong>Arduino</strong> เท่านั้น)</p>
<p>&nbsp;</p>
<hr />
<p><em>This work is licensed under a</em> <strong><em>Creative Commons Attribution-ShareAlike 4.0 International License</em></strong>.</p>
<p>Created: 2021-12-23 | Last Updated: 2021-12-26</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2021-2022 IoT Engineering Education, Bangkok/Thailand</a></p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../js/extra.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
