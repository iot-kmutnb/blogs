<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="RSP">
        <link rel="canonical" href="http://iot-kmutnb.github.com/blogs/training/geany_editor/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>การใช้ซอฟต์แวร์ Geany เพื่อการเขียนโปรแกรมภาษา C/C++ สำหรับระบบปฏิบัติการ Linux - IoT Engineering Education</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
        <link href="../../css/extra.css" rel="stylesheet">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/c.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/cpp.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/arduino.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/javascript.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/typescript.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/json.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/rust.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/vhdl.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/verilog.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/bash.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/text.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/matlab.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/julia.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-966FQ6RN6W"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'G-966FQ6RN6W');
        </script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">IoT Engineering Education</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="../../about/" class="nav-link">About</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#geany-cc-linux" class="nav-link">การใช้ซอฟต์แวร์ Geany เพื่อการเขียนโปรแกรมภาษา C/C++ สำหรับระบบปฏิบัติการ Linux</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#geany-editor" class="nav-link">&#9655; Geany Editor</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#build-geany-from-source-code" class="nav-link">&#9655; Build Geany from Source Code</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#geany-editor_1" class="nav-link">&#9655; การสร้างโปรเจกต์และดีบักโค้ดภาษาด้วย Geany Editor</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#makefile-geany-editor" class="nav-link">&#9655; การใช้งาน Makefile ร่วมกับ Geany Editor</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_1" class="nav-link">&#9655; กล่าวสรุป</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="geany-cc-linux">การใช้ซอฟต์แวร์ Geany เพื่อการเขียนโปรแกรมภาษา C/C++ สำหรับระบบปฏิบัติการ Linux<a class="headerlink" href="#geany-cc-linux" title="Permanent link">#</a></h1>
<hr />
<h2 id="geany-editor">&#9655; <strong>Geany Editor</strong><a class="headerlink" href="#geany-editor" title="Permanent link">#</a></h2>
<p>ในปัจจุบันมีตัวเลือกที่เป็นซอฟต์แวร์ประเภท <strong>IDE</strong> สำหรับการเขียนโค้ดด้วยภาษา <strong>C/C++</strong> เช่น</p>
<ul>
<li><strong>Microsoft Visual Studio Code IDE</strong></li>
<li><strong>JetBrains CLion IDE</strong></li>
<li><strong>Eclipse IDE + CDT</strong></li>
<li><strong>Codeblocks</strong></li>
<li><strong>Geany Editor</strong></li>
</ul>
<p>ในบทความนี้จะกล่าวถึง การติดตั้งและใช้งาน <strong>Geany Editor</strong> (<a href="https://geany.org/">https://geany.org/</a>) ซึ่งเป็นซอฟต์แวร์ประเภท <strong>Light-weight, Open Source, Cross-platform, GTK-based IDE</strong> (<strong><em>Integrated Development Environment</em></strong>)
นำมาติดตั้งใช้งานได้กับ <strong>Windows</strong>, <strong>Linux</strong>, <strong>Mac OS X</strong> 
เพื่อใช้ในการเขียนโค้ดด้วยภาษาคอมพิวเตอร์ เช่น <strong>C/C++</strong> และได้อีกหลายภาษา</p>
<p><img alt="" src="geany_website.png" /></p>
<p>รูป: <strong>Geany.org</strong></p>
<p><strong>Geany</strong> เป็นซอฟต์แวร์ประเภท <strong>Code Editor / IDE</strong> เหมาะสำหรับผู้เริ่มต้นใช้งานและฝึกเขียนโค้ดภาษา
<strong>C/C++</strong> เช่น สำหรับผู้ใช้งานบอร์ด <strong>Raspberry Pi</strong> ร่วมกับระบบปฏิบัติการ <strong>Raspbian OS</strong> </p>
<p><strong>Geany</strong> อ่านออกเสียงว่า <em>"jee-nee"</em> (จีน-นี) แต่เนื่องจากผู้พัฒนาคนแรกนั้นเป็นชาวเยอรมัน
การออกเสียงจึงน่าจะเหมือนคำในภาษาเยอรมันว่า <strong>Genie</strong> ที่แปลว่า <strong>genius</strong> ในภาษาอังกฤษ</p>
<p><strong>Geany</strong> มีส่วนเสริม หรือ <a href="https://plugins.geany.org/"><strong>Plug-ins</strong></a>
ที่นำมาติดตั้งเพิ่มได้ เช่น <strong>Code Navigator</strong> และ <strong>Source-Level Debugger</strong> 
ซึ่งช่วยให้ผู้ใช้สามารถดีบักการทำงานของโค้ด โดยใช้โปรแกรม <strong>GDB (The GNU Project Debugger)</strong> เช่น สามารถกำหนดตำแหน่งที่เป็นบรรทัดต่าง ๆ ในโค้ด เรียกว่า บรรทัดที่หยุดชั่วคราว หรือ <strong>Breakpoints</strong> และเมื่อทำคำสั่งมาถึงตำแหน่งดังกล่าว ก็จะหยุดชั่วคราว และดูการเปลี่ยนแปลงค่าของตัวแปรในขณะนั้นได้ หรือจะให้ทำคำสั่งไปทีละบรรทัดในโค้ดก็ได้</p>
<p>&nbsp;</p>
<hr />
<h2 id="build-geany-from-source-code">&#9655; <strong>Build Geany from Source Code</strong><a class="headerlink" href="#build-geany-from-source-code" title="Permanent link">#</a></h2>
<p>โดยปรกติแล้ว ถ้าใช้ <strong>Ubuntu</strong> หรือ <strong>Raspbian OS</strong> ก็สามารถติดตั้ง <strong>Geany Editor</strong>
และ <strong>Plugins</strong> ได้ โดยใช้คำสั่งต่อไปนี้ (ดูวิธีการติดตั้งได้จาก 
<a href="https://plugins.geany.org/install.html">https://plugins.geany.org/install.html</a></p>
<pre><code class="language-bash">sudo apt install -y geany geany-plugins
</code></pre>
<p>แต่ในบทความนี้ จะแนะนำให้ลองเรียนรู้ขั้นตอนการคอมไพล์โค้ดจากซอร์สโค้ดของ <strong>Geany Editor</strong> และ <strong>Geany Plugins</strong> ซึ่งจะต้องเลือกเวอร์ชันให้ตรงกันด้วย และเวอร์ชันของ <strong>Geany</strong> ล่าสุดที่ได้ลองใช้ในการเขียนบทความนี้คือ <strong>v1.38</strong></p>
<p>เนื่องจากจะต้องมีการทำคำสั่งหลายคำสั่งใน <strong>Bash Shell</strong> ดังนั้นเพื่อความสะดวก จึงได้จัดทำไฟล์ชื่อ <code>install_geany.sh</code> ซึ่งเป็น <strong>Bash Script File</strong>
สำหรับวัตถุประสงค์ดังกล่าว</p>
<p>&nbsp;
<strong>File:</strong> <a href="install_geany.sh"><code>install_geany.sh</code></a> (<em>Click to download</em>)</p>
<pre><code class="language-bash">#!/usr/bin/env bash

# set the version of Geany
GEANY_VERSION=1.38

if [ -x $(command -v geany) ]; then
  echo &quot;uninstall geany...&quot;
  sudo apt remove -y --purge geany geany-common geany-plugins
fi

if ! [ -x $(command -v wget) ]; then
  echo &quot;install wget&quot;
  sudo apt install -y wget
fi

# install necessary packages to build Geany from sourcecode
sudo apt install -y build-essential automake autoconf \
  pkg-config intltool libgtk-3-dev libvte-2.91-dev \
  gdb cppcheck 

#-------------------------------------------------------
# set the URL
URL=https://download.geany.org
# set the filename of the GEANY archive file
ARCHIVE_FILE=geany-${GEANY_VERSION}.tar.gz
# download the archive file of Geany source code (.tar.gz)
result=$(wget -c ${URL}/${ARCHIVE_FILE} -O ${ARCHIVE_FILE})
if [ $? -ne 0 ] || ! [ -f ${ARCHIVE_FILE} ]; then
   echo &quot;Cannot download ${ARCHIVE_FILE} or file doesn't exist!&quot;
   exit -1
fi
# extract the compressed archive file
tar xvfz ${ARCHIVE_FILE}
# change the working directory
cd geany-${GEANY_VERSION}/
# configure and build the source code
result=$(./configure &amp;&amp; make -j 4)
if [ $? -ne 0 ]; then
   &quot;Geany: configure or make failed&quot;
   exit -1
fi
# install the binary file of Geany
sudo make install
# remove the sourcecode directory
rm -fr geany-${GEANY_VERSION}

#-------------------------------------------------------
# set the filename of the GEANY-plugins archive file
ARCHIVE_FILE=geany-plugins-${GEANY_VERSION}.tar.gz
# set the URL
URL=https://plugins.geany.org/geany-plugins
# download the source code .tar.gz file
result=$(wget ${URL}/${ARCHIVE_FILE} -O ${ARCHIVE_FILE})
if [ $? -ne 0 ] || ! [ -f ${ARCHIVE_FILE} ]; then
   echo &quot;Cannot download ${ARCHIVE_FILE} or file doesn't exist!&quot;
   exit -1
fi
# extract the compressed archive file
tar xvfz ${ARCHIVE_FILE}
# change the working directory
cd ./geany-plugins-${GEANY_VERSION}
# configure and build the source code
result=$(./configure --enable-debugger &amp;&amp; make -j 4)
if [ $? -ne 0 ]; then
   &quot;Geany-plugins: configure or make failed&quot;
   exit -1
fi
# install the shared lib files for Geany plugins
sudo make install
# reload the configuration files under /etc/ld.so.conf.d/
sudo ldconfig -v
# remove the sourcecode directory
rm -fr ./geany-plugins-${GEANY_VERSION}
#-------------------------------------------------------
echo &quot;Done...&quot;
</code></pre>
<p>&nbsp;</p>
<p>เมื่อได้ดาวน์โหลดไฟล์ <code>install_geany.sh</code> มาแล้ว ให้เปลี่ยนโหมดของไฟล์เป็น <strong>Executable File</strong>
โดยทำคำสั่งต่อไปนี้ แล้วจึงเรียกใช้เพื่อทำขั้นตอนการติดตั้ง</p>
<pre><code class="language-bash">$ chmod +x ./install_geany.sh
$ ./install_geany.sh
</code></pre>
<p>&nbsp;</p>
<p>ในบทความนี้ได้ทดลองติดตั้งใน  <strong>Ubuntu Desktop 22.04 LTS</strong> ที่ทำงานด้วย
<strong>Virtual Machine (VM)</strong> โดยใช้ซอฟต์แวร์ <strong>Oracle VirtualBox</strong> และ <strong>Raspbian OS</strong>
สำหรับบอร์ด <strong>Raspbery Pi Model 4B</strong></p>
<p><img alt="" src="ubuntu_geany_inst-1.png" /></p>
<p>รูป: แสดงข้อความที่ปรากฎเมื่อทำขั้นตอนการติดตั้งใน <strong>Ubuntu Desktop</strong> 
และจะเห็นได้ว่า มีการดาวน์โหลดและติดตั้งแพ็กเกจต่าง ๆ จากอินเทอร์เน็ต</p>
<p><img alt="" src="ubuntu_geany_inst-2.png" /></p>
<p>รูป: ข้อความเอาต์พุตในช่วงที่มีการดาวน์โหลดไฟล์ <code>geany-v1.38.tar.gz</code>
และแตกไฟล์ดังกล่าวในไดเรกทอรีใหม่</p>
<p><img alt="" src="ubuntu_geany_inst-3.png" /></p>
<p>รูป: ข้อความเอาต์พุตในช่วงสุดท้าย เมื่อได้ติดตั้ง <strong>Geany</strong> และ <strong>Geany Plugins</strong>
ในระบบได้สำเร็จแล้ว</p>
<p><img alt="" src="ubuntu_geany_inst-4.png" /></p>
<p>รูป: มีรูปสัญลักษณ์ <strong>Icon</strong> เพิ่มเข้ามา บนหน้า <strong>Ubuntu Desktop</strong>
ทำให้เรียกใช้งานโปรแกรม <strong>Geany</strong> ได้สะดวก</p>
<p>การเรียกใช้ <strong>Geany</strong> ด้วยคำสั่งใน <strong>Bash Shell</strong> ก็ทำได้ดังนี้
(ข้อความใด ๆ ที่เกิดจากการทำงานของโปรแกรม และแสดงผ่านทาง <strong>stdout</strong> และ <strong>stderr</strong>
จะถูกส่งไปยังไฟล์ในระบบที่มีชื่อว่า  <code>/dev/null</code> ดังนั้นจะไม่ปรากฏข้อความใด ๆ ให้ผู้ใช้เห็น)</p>
<pre><code class="language-bash">$ geany --version
geany 1.38 (built on 2022-08-29 with GTK 3.24.33, GLib 2.72.1)
$ geany &gt; /dev/null 2&gt;&amp;1 &amp;
</code></pre>
<p><img alt="" src="geany_ubuntu.png" /></p>
<p>รูป: การเปิดใช้งาน <strong>Geany Editor</strong> ใน <strong>Ubuntu Desktop 22.04 LTS</strong></p>
<p><img alt="" src="geany_on_rpi4.png" /></p>
<p>รูป: การเปิดใช้งาน <strong>Geany Editor</strong> ใน <strong>Raspbian OS (64-bit, Bullseye)</strong></p>
<p>&nbsp;</p>
<hr />
<h2 id="geany-editor_1">&#9655; <strong>การสร้างโปรเจกต์และดีบักโค้ดภาษาด้วย Geany Editor</strong><a class="headerlink" href="#geany-editor_1" title="Permanent link">#</a></h2>
<p>เมื่อเปิดใช้งาน <strong>Geany Editor</strong> ให้ไปที่เมนู <strong>File</strong> แล้วสร้างไฟล์ใหม่ <code>hello.c</code> หรือเปิดไฟล์ที่มีอยู่แล้ว 
จากนั้นไปที่เมนู <strong>Build &gt; Set Build Commands</strong> เพื่อตรวจสอบการตั้งค่าเพื่อเลือกใช้คำสั่งในการคอมไพล์โค้ด
(แบ่งเป็นคำสั่งสำหรับขั้นตอน <strong>Compile</strong>, <strong>Build</strong>, <strong>Lint</strong>) ตามรูปตัวอย่าง</p>
<p><img alt="" src="geany_build_commands.png" /></p>
<p>รูป: การตั้งค่าสำหรับ <strong>Set Build Commands</strong> (สังเกตว่า การใช้คำสั่ง <code>gcc</code> จะต้องมี <code>-g</code> 
เพื่อระบุว่า เป็นการคอมไพล์โค้ดเพื่อใช้ในการดีบัก)</p>
<p>สำหรับขั้นตอนดีบักโค้ด ให้ไปที่เมนู <strong>Tools &gt; Plugin Manager</strong> แล้วคลิกเลือกรายการ <strong>Debugger</strong>
จากนั้นจะมี <strong>Tab</strong> ชื่อ <strong>Debug</strong>  ในแนวตั้งทางซ้ายมือ </p>
<p><img alt="" src="geany_enable_debugger.png" /></p>
<p>รูป: การเลือกใช้ <strong>Geany Debugger Plugin</strong></p>
<p>ถัดไปเป็นโค้ดตัวอย่างภาษา <strong>C</strong> ให้ลองแก้ไขไฟล์ <code>hell.c</code> แล้วบันทึกการเปลี่ยนแปลง
จากนั้นทำคำสั่งจากเมนู <strong>Build &gt; Build</strong> ซึ่งจะได้ไฟล์ <code>hello</code></p>
<pre><code class="language-c">#include &lt;stdio.h&gt;

int main(int argc, char **argv) {
  printf( &quot;Hello World!\n&quot; );
  for ( int i=0; i &lt; 10; i++ ) {
    printf( &quot;i = %d\n&quot;, i );
  } 
  return 0;
}
</code></pre>
<p>&nbsp;</p>
<p>จากนั้นให้คลิกเลือก <strong>Debug Tab</strong> ที่อยู่ทางซ้ายมือ แล้วไปที่ <strong>Target Tab</strong>
ในช่อง <strong>Target</strong> ให้ระบุที่อยู่ของไฟล์ <code>hello</code> ที่ได้จากขั้นตอน <strong>Build</strong>
(ให้ระบุชื่อเป็น <strong>Full path name</strong>) และเลือก <strong>GDB</strong> เป็น <strong>Debugger</strong></p>
<p><img alt="" src="geany_debug_setting.png" /></p>
<p>รูป: การตั้งค่าสำหรับการดีบักโค้ด เมื่อคอมไพล์โค้ด <code>hello.c</code> ได้แล้ว</p>
<p>ให้ลองคลิกเลือกเลขบรรทัดในไฟล์ <code>hello.c</code> เพื่อกำหนดตำแหน่ง <strong>Breakpoint</strong>
(สามารถมีได้หลายตำแหน่งในโค้ด) และให้สังเกตว่า หลังเลขบรรทัดจะมีสัญลักษณ์ <strong>Diamond</strong> แสดงกำกับเอาไว้</p>
<p>เมื่อกดปุ่มรัน (<strong>Run</strong>) เพื่อให้มีการรันโค้ด แต่จะมาหยุดชั่วคราวที่ตำแหน่ง <strong>Breakpoint</strong>
หากมีการกำหนดเอาไว้ในโค้ด และก็สามารถทำคำสั่งต่อไป หรือทำทีละคำสั่งก็ได้ (ให้สังเกต กลุ่มของปุ่มต่าง ๆ ที่อยู่ทางด้านขวามือ) และในหน้าต่าง <strong>Debug Terminal</strong> จะมีข้อความเอาต์พุตที่ได้จากการทำงานของโปรแกรม</p>
<p><img alt="" src="geany_debug_run.png" /></p>
<p>รูป: การดีบักโค้ดเมื่อมีการกำหนดตำแหน่ง <strong>Breakpoint</strong>
ซึ่งจะเห็นได้ว่า เมื่อรันโค้ด จะมีการหยุดตรงบรรทัดที่ 6 ในโค้ด <code>hello.c</code>
และมีข้อความเอาต์พุตการทำงานของโปรแกรม แสดงค่าของตัวแปร <code>i</code> ที่มีการเปลี่ยนแปลงเพิ่มขึ้น
จากการทำงานของประโยคคำสั่ง <code>for</code></p>
<p>&nbsp;</p>
<hr />
<h2 id="makefile-geany-editor">&#9655; <strong>การใช้งาน Makefile ร่วมกับ Geany Editor</strong><a class="headerlink" href="#makefile-geany-editor" title="Permanent link">#</a></h2>
<p>ในกรณีที่ซอร์สโค้ดของโปรเจกต์ประกอบด้วยไฟล์ <code>.c</code> และ <code>.h</code> หลาย ๆ ไฟล์ และต้องการจะใช้งานร่วมกับ
<strong>Geany Editor</strong> แนะนำให้สร้างไฟล์ที่เรียกว่า <strong>Makefile</strong> และเรียกใช้คำสั่ง 
<a href="https://www.gnu.org/software/make/manual/make.html"><strong>GNU Make</strong></a> สำหรับไฟล์ดังกล่าว</p>
<p>ถัดไปลองมาดูตัวอย่างโค้ด ซึ่งประกอบด้วยไฟล์ต่อไปนี้</p>
<ul>
<li><code>ping.h</code> เป็นไฟล์ที่มีประกาศรูปแบบของฟังก์ชัน ได้แก่
<code>exec_ping()</code> และ <code>pipe_ping()</code> เพื่อทำคำสั่ง <code>ping</code> และจะมีการเรียกใช้ฟังก์ชันในไฟล์ <code>main.c</code></li>
<li><code>ping.c</code> เป็นไฟล์ที่มีการสร้างฟังก์ชันตามที่ได้มีการประกาศไว้ในไฟล์ <code>ping.h</code></li>
<li><code>main.c</code> มีฟังก์ชัน <code>main</code> ที่มีการเรียกใช้ฟังก์ชันจากไฟล์ <code>ping.h</code> </li>
</ul>
<p><strong>Zip file</strong>: <a href="ping-src.zip"><code>ping-src.zip</code></a></p>
<hr />
<p><strong>File:</strong> <a href="ping-src/ping.h"><code>ping.h</code></a></p>
<pre><code class="language-c">#ifndef __PING_H
#define __PING_H

#include &lt;stdio.h&gt;  // for printf(), snprintf()
#include &lt;stdlib.h&gt; // for system() 

int exec_ping( const char *cmd );
int pipe_ping( const char *cmd );

#endif
</code></pre>
<p><strong>File:</strong> <a href="ping-src/ping.c"><code>ping.c</code></a></p>
<pre><code class="language-c">#include &quot;ping.h&quot;

#define PING_BUF_LEN (128)

int exec_ping( const char *cmd ) {
  if( cmd == NULL ) { return -1; }
  int status = system( cmd ); // execute the ping command
  return status &gt;&gt; 8; // status code divided by 256
}

int pipe_ping( const char *cmd ) {
  if( cmd == NULL ) { return -1; }
  char buf[ PING_BUF_LEN ];
  FILE *fp;
  // run the command and open the pipe 
  if ((fp = popen(cmd, &quot;r&quot;)) == NULL) {
    printf( &quot;Error opening pipe!\n&quot; );
    return -1;
  }
  // read from pipe iine by line (limited by PING_BUF_LEN)
  while (fgets(buf, PING_BUF_LEN, fp) != NULL) {
    printf( &quot;&gt; %s&quot;, buf ); // show output from the ping command
  }
  // close the pipe
  if ( pclose(fp) ) {
    return -1; // command not found or exited with error
  }
  return 0; // status ok
}
</code></pre>
<p><strong>File:</strong> <a href="ping-src/main.c"><code>main.c</code></a></p>
<pre><code class="language-c">#include &lt;stdio.h&gt;  // for printf(), sprintf()
#include &quot;ping.h&quot;   // for exec_ping(), pipe_ping()

int main( int argc, char **argv ) {
  char cmd[32]; 
  sprintf( cmd, &quot;/usr/bin/ping %s -c %u&quot;, &quot;8.8.8.8&quot;, 5 );
  // send a ping packet to 8.8.8.8 (Google DNS server) 5 times
  // Method 1)
  if ( exec_ping( cmd ) != 0 ) {
    printf( &quot;PING command execution using system() failed!&quot; );
  }
  // Method 2)
  if ( pipe_ping( cmd ) != 0 ) {
    printf( &quot;PING command execution using popen() failed!&quot; );
  }
  return 0;
}
</code></pre>
<p>ถ้าจะทำคำสั่งเพื่อคอมไพล์โค้ดใน <strong>Bash Shell</strong> ก็ทำได้ตามลำดับดังนี้</p>
<pre><code class="language-bash">$ gcc -Wall -g -I. -c ping.c
$ gcc -Wall -g -I. -c main.c
$ gcc -Wall -g main.o ping.o -o main
</code></pre>
<p>&nbsp;</p>
<p>ลองมาดูตัวอย่างการสร้างไฟล์ <code>Makefile</code> ที่ใช้สำหรับการคอมไพล์โค้ดของโปรเจกต์</p>
<p><strong>File:</strong> <a href="ping-src/Makefile"><code>Makefile</code></a></p>
<pre><code># use the GCC C compiler
CC=gcc
# enable compilation warning and turn on debug info
CFLAGS +=-std=gnu99 -Wall -Og -g3
# define source files (all .c files in the project directory)
SRCS = $(wildcard *.c)
# define object files
OBJ_FILES = $(SRCS:.c=.o)
# define Phony targets
.PHONY: all clean
all: main
    @echo &quot;done...&quot;
main: $(OBJ_FILES)
    $(CC) $(CFLAGS) $^ -o $@
%.o: %.c # use pattern rules
    $(CC) $(CFLAGS) -c $&lt;
clean:
    rm -f *.o main
</code></pre>
<p>โดยทั่วไปแล้ว ภายใน <strong>Makefile</strong> จะมีการสร้างกฎ (<strong>Rule</strong>) สำหรับการทำคำสั่งต่าง ๆ 
(เรียกว่า <strong>Action</strong>) และมีการประกาศตัวแปรได้ (<strong> Variable Definitions</strong>)
เช่น <code>CC</code> และ <code>CFLAGS</code> เป็นต้น</p>
<p>กฎในแต่ละข้อ จะเริ่มต้นด้วยชื่อ (เรียกว่า <strong>Target Name</strong>) แล้วตามด้วย <code>:</code>  เช่น <code>all</code> หรือ <code>clean</code> เป็นต้น 
และอาจมีเงื่อนไขในการทำกฎแต่ละข้อได้ (เรียกว่า  <strong>Condition</strong> หรือ <strong>Dependency</strong>) เขียนต่อท้ายไว้ในบรรทัดเดียวกัน และมีรายการคำสั่งที่เกี่ยวข้องในบรรทัดถัดไป มีได้หลายบรรทัด แต่ละบรรทัดจะต้องเริ่มด้วย <strong>Tab</strong> เท่านั้น</p>
<p>ยกตัวอย่างเช่น  <code>main</code> เป็นชื่อ <strong>Target</strong> และมีเงื่อนไขว่า จะต้องมีไฟล์ <strong>.o</strong> ตามที่กำหนดไว้ในตัวแปร
<code>$(OBJ_FILES)</code> แต่ถ้ายังไม่มีไฟล์เหล่านั้น ให้ไปดำเนินการกับ <strong>Target</strong> ที่มีชื่อว่า <code>%.o</code> ก่อน
โดยที่ <code>%.o</code> หมายถึง ชื่อไฟล์ใด ๆ ที่ลงท้ายด้วย <code>.o</code> และจะได้จากการคอมไพล์ไฟล์ <code>.c</code> ที่มีชื่อตรงกัน </p>
<p>เมื่อสร้างไฟล์ <code>Makefile</code> แล้ว ก็สามารถเรียกใช้งานด้วยคำสั่ง <code>make</code> (<strong>GNU make</strong>) ได้ดังนี้</p>
<pre><code class="language-bash">$ make clean &amp;&amp; make 
</code></pre>
<p><img alt="" src="ubuntu_makefile_demo.png" /></p>
<p>รูป: ตัวอย่างการรันคำสั่ง <code>make</code> โดยเรียกใช้ไฟล์ <code>Makefile</code> ตามตัวอย่าง</p>
<p>&nbsp;</p>
<p>เมื่อได้สร้างไฟล์ <code>Makefile</code> และไฟล์สำหรับซอร์สโค้ดเป็นตัวอย่างแล้ว ถัดไปลองมาเรียกใช้จาก <strong>Geany Editor</strong></p>
<p><img alt="" src="geany_make.png" /></p>
<p>รูป: ตัวอย่างการรันคำสั่ง <code>make</code> ใน <strong>Geany</strong> จากเมนูคำสั่ง <strong>Build &gt; Make</strong></p>
<p>คำสั่งตรวจสอบรายการไฟล์ต่าง ๆ ในไดเรกทอรีของซอร์สโค้ด</p>
<pre><code class="language-bash">$ tree -L 1
.
├── main.c
├── Makefile
├── ping.c
└── ping.h
0 directories, 4 files
</code></pre>
<p>และเมื่อทำคำสั่ง <code>make</code> แล้ว จะมีรายการไฟล์เพิ่มขึ้น</p>
<pre><code class="language-bash">$ tree -L 1
.
├── main
├── main.c
├── main.o
├── Makefile
├── ping.c
├── ping.h
└── ping.o
0 directories, 7 files
</code></pre>
<p>&nbsp;</p>
<hr />
<h2 id="_1">&#9655; <strong>กล่าวสรุป</strong><a class="headerlink" href="#_1" title="Permanent link">#</a></h2>
<p>บทความนี้ได้นำเสนอขั้นตอนการติดตั้งและใช้งาน <strong>Geany Editor</strong> สำหรับ <strong>Ubuntu Linux</strong>
(และ <strong>Raspbian OS</strong>) สาธิตการใช้งานเพื่อเขียนโค้ดภาษา <strong>C/C++</strong> การคอมไพล์จากซอร์สโค้ด รวมถึงขั้นตอนการดีบักโค้ด
(<strong>Source-Level Debugging</strong>) และการสร้างไฟล์ <code>Makefile</code> เพื่อใช้กับคำสั่ง <code>make</code>
ในการคอมไพล์โค้ดที่มีหลายไฟล์ร่วมกับซอฟต์แวร์ <strong>Geany Editor</strong></p>
<p>&nbsp;</p>
<hr />
<p>This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International License.</p>
<p>Created: 2022-08-29 | Last Updated: 2022-09-09</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2021-2023 IoT Engineering Education, Bangkok/Thailand</a></p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
