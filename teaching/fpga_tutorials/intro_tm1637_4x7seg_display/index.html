<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="RSP">
        <link rel="canonical" href="https://iot-kmutnb.github.io/blogs/teaching/fpga_tutorials/intro_tm1637_4x7seg_display/">
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>Tutorial: TM1637-based 7-Segment Display Module - IoT Engineering Education</title>
        <link href="../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../../css/brands.min.css" rel="stylesheet">
        <link href="../../../css/solid.min.css" rel="stylesheet">
        <link href="../../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <link href="../../../css/extra.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/c.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/cpp.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/arduino.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/javascript.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/typescript.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/json.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/vhdl.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/verilog.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/bash.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/text.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/plaintext.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/matlab.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/julia.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/go.min.js"></script>
        <script>hljs.highlightAll();</script>
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-966FQ6RN6W"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', "G-966FQ6RN6W");
        </script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../..">IoT Engineering Education</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../../.." class="nav-link">Home</a>
                            </li>
                            <li class="nav-item">
                                <a href="../../../about/" class="nav-link">About</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#tutorial-tm1637-based-7-segment-display-module" class="nav-link">Tutorial: TM1637-based 7-Segment Display Module</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#tm1637-ic" class="nav-link">TM1637 IC</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#tm1637-based-4-digit-7-segment-display-module" class="nav-link">TM1637-based 4-Digit 7-Segment Display Module</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#tm1637-programming" class="nav-link">TM1637 Programming</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#vhdl-coding-examples-for-fpga" class="nav-link">VHDL Coding Examples for FPGA</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="tutorial-tm1637-based-7-segment-display-module"><strong>Tutorial: TM1637-based 7-Segment Display Module</strong><a class="headerlink" href="#tutorial-tm1637-based-7-segment-display-module" title="Permanent link">#</a></h1>
<hr />
<h2 id="tm1637-ic"><strong>TM1637 IC</strong><a class="headerlink" href="#tm1637-ic" title="Permanent link">#</a></h2>
<p><strong>Time-multiplexing</strong> is a technique that helps reduce the number of control pins needed for multi-digit 7-segment displays, while keeping full control over each individual digit. Nowadays, there are specialized LED driver/controller ICs designed for these displays, like the TM1637 and TM1640, which can also handle dot-LED matrices.</p>
<p>In this tutorial, we will use the <a href="datasheet-en.pdf"><strong>TM1637 IC</strong></a> to drive a 4-digit 7-segment display module, which is usually set up in a common-anode configuration (not common-cathode). The TM1637 connects with a microcontroller or an FPGA using just two signal lines: a clock line (<code>CLK</code>) and a bidirectional data line (<code>DIO</code>). Don’t forget, both lines need external pull-up resistors, typically around <strong>10kΩ</strong>.</p>
<p>&nbsp;</p>
<hr />
<h2 id="tm1637-based-4-digit-7-segment-display-module"><strong>TM1637-based 4-Digit 7-Segment Display Module</strong><a class="headerlink" href="#tm1637-based-4-digit-7-segment-display-module" title="Permanent link">#</a></h2>
<p>The figure below shows a <strong>4-digit 7-segment display module</strong> that 
operates with the <strong>TM1637 chip</strong> as its controller or driver. 
Depending on the model, there are different digit sizes (like 0.36" or 0.56"),
and some versions come with <strong>decimal points</strong> (<code>.</code>) for each digit or colon symbols (<code>:</code>), which are quite handy for showing time in a digital clock format.</p>
<p><img alt="" src="tm1637_4x7seg_module.jpg" /></p>
<p><strong>Figure:</strong> TM1637-based 4-digit 7-segment module</p>
<p><img alt="" src="tm1637_schematic_example.jpg" /></p>
<p><strong>Figure:</strong> Schematic example of a TM1637-based 7-segment display module</p>
<p><strong>Note:</strong></p>
<ul>
<li>Although the VCC of the <strong>TM1637-based</strong> display module is rated at "+5V", 
it often operates reliably at <strong>+3.3V</strong> as well (but with less brightness).</li>
</ul>
<p>&nbsp;</p>
<hr />
<h2 id="tm1637-programming"><strong>TM1637 Programming</strong><a class="headerlink" href="#tm1637-programming" title="Permanent link">#</a></h2>
<p>The figure below shows the sequence of sending command and data bytes to the TM1637 IC.
This process is used to write display data into the TM1637’s internal SRAM,
starting from a specified address and automatically incrementing for subsequent data bytes.</p>
<p><img alt="" src="write_sram.jpg" /></p>
<p><strong>Figure:</strong> Write SRAM data process</p>
<p>The protocol follows a structured sequence of start conditions, commands, data transfers, and acknowledgments (ACKs) over the <code>CLK</code> and <code>DIO</code> lines.</p>
<ul>
<li><strong>Start Condition</strong>: The host (MCU or FPGA) begins communication with a start condition (falling edge of <code>DIO</code> while <code>CLK</code> is high).</li>
<li><strong>Command1 = Set Data Command (<code>0x40</code>)</strong>:
This step sends a data command byte that enables auto-increment mode.</li>
<li><strong>Command2 = Set Address Command (<code>0xC0</code>)</strong>:
This step sends an address command byte to specify the starting SRAM address where display data will be written.</li>
<li><strong>Display Data Bytes</strong>:
This step sequentially writes 1 to N data bytes to the display.
Each byte corresponds to the segment pattern for one digit.
The TM1637 auto-increments the address after each byte.</li>
<li><strong>Command3 = Display Control Command</strong>
This sends a command to set the brightness level and turn display on.</li>
<li><strong>Stop Condition</strong>:
A stop condition is sent by the host to finish communication.
This occurs when <code>DIO</code> goes high while <code>CLK</code> is high.</li>
</ul>
<p><img alt="" src="cmd_data_set.jpg" /></p>
<p><strong>Figure:</strong> Options for data set command</p>
<p><img alt="" src="cmd_addr_set.jpg" /></p>
<p><strong>Figure:</strong> Options for address set command</p>
<p><img alt="" src="cmd_disp_ctrl.jpg" /></p>
<p><strong>Figure:</strong> Options for the display control command</p>
<p>&nbsp;</p>
<hr />
<h2 id="vhdl-coding-examples-for-fpga"><strong>VHDL Coding Examples for FPGA</strong><a class="headerlink" href="#vhdl-coding-examples-for-fpga" title="Permanent link">#</a></h2>
<p>This VHDL module (tm1637_driver) implements a low-level driver for 
the TM1637 LED controller IC. It has the following control/status signals.</p>
<ul>
<li><code>START</code>: Begins a write transaction</li>
<li><code>STOP</code>: Indicates if the current byte is the last</li>
<li><code>DC</code>:  Select either data or command byte to transmit</li>
<li><code>DONE</code>: Signals the end of the transaction</li>
<li><code>ACK</code>: Indicates acknowledgment from the TM1637</li>
</ul>
<p>The <code>CLK</code> and <code>DIO</code> are bidirectional I/O signals for the TM1637 IC.</p>
<pre><code class="language-VHDL">TM_CLK : INOUT STD_LOGIC;
TM_DIO : INOUT STD_LOGIC;
</code></pre>
<p>These lines are <strong>open-drain (open-collector)</strong>, they can only be driven low 
or released (<strong>high-Z</strong>). Pull-up resistors pull them high when not driven.</p>
<pre><code class="language-VHDL">-- File: tm1637_driver.vhd
LIBRARY IEEE;
USE IEEE.STD_LOGIC_1164.ALL;
USE IEEE.NUMERIC_STD.ALL;

ENTITY tm1637_driver IS
    PORT (
        CLK    : IN STD_LOGIC;
        RST_N  : IN STD_LOGIC;
        START  : IN STD_LOGIC; -- start write operation
        STOP   : IN STD_LOGIC;
        DC     : IN STD_LOGIC_VECTOR(7 DOWNTO 0); -- data or cmd byte
        TM_CLK : INOUT STD_LOGIC;
        TM_DIO : INOUT STD_LOGIC;
        DONE   : OUT STD_LOGIC;
        ACK    : OUT STD_LOGIC -- ACK or NACK status
    );
END tm1637_driver;

ARCHITECTURE behavioral OF tm1637_driver IS

    TYPE state_type IS (
        ST_IDLE,
        ST_START,
        ST_SHIFT_CLK_L,
        ST_SHIFT_CLK_H,
        ST_ACK,
        ST_READ_ACK,
        ST_STOP,
        ST_DONE
    );

    SIGNAL state      : state_type := ST_IDLE;
    SIGNAL next_state : state_type := ST_IDLE;

    SIGNAL bit_cnt    : INTEGER RANGE 0 TO 7 := 0;
    SIGNAL shift_reg  : STD_LOGIC_VECTOR(7 DOWNTO 0) := (OTHERS =&gt; '0');

    -- Output control signals
    SIGNAL tm_clk_oe  : STD_LOGIC := '0'; -- 1 = drive, 0 = high-Z
    SIGNAL tm_dio_oe  : STD_LOGIC := '0'; -- 1 = drive, 0 = high-Z

    -- Clock divider: adjust for target frequency
    --CONSTANT CLK_DIV : INTEGER := 125;
    CONSTANT CLK_DIV   : INTEGER := 1000;
    --CONSTANT CLK_DIV : INTEGER := 5000;
    SIGNAL clk_count   : INTEGER RANGE 0 TO CLK_DIV - 1 := 0;
    SIGNAL clk_en      : STD_LOGIC := '0';

    -- ACK read
    SIGNAL ack_bit     : STD_LOGIC := '1';
    SIGNAL stop_bit    : STD_LOGIC := '1';

BEGIN
    -- Assign outputs
    TM_CLK &lt;= '0' WHEN tm_clk_oe = '1' ELSE 'Z';
    TM_DIO &lt;= '0' WHEN tm_dio_oe = '1' ELSE 'Z';
    ACK &lt;= ack_bit;

    -- Clock Divider: Generate clk_en pulse
    clk_div_proc : PROCESS (RST_N, CLK)
    BEGIN
        IF RST_N = '0' THEN
            clk_count &lt;= 0;
            clk_en &lt;= '0';
        ELSIF rising_edge(CLK) THEN
            IF clk_count = CLK_DIV - 1 THEN
                clk_count &lt;= 0;
                clk_en &lt;= '1';
            ELSE
                clk_count &lt;= clk_count + 1;
                clk_en &lt;= '0';
            END IF;
        END IF;
    END PROCESS;

    -- FSM Process
    fsm_proc : PROCESS (RST_N, CLK)
    BEGIN
        IF RST_N = '0' THEN
            state     &lt;= ST_IDLE;
            tm_clk_oe &lt;= '0';
            tm_dio_oe &lt;= '0';
            bit_cnt   &lt;= 0;
            ack_bit   &lt;= '1';
            stop_bit  &lt;= '1';
            DONE      &lt;= '1';

        ELSIF rising_edge(CLK) THEN
            IF clk_en = '1' THEN
                CASE state IS
                    WHEN ST_IDLE =&gt;
                        DONE &lt;= '1';
                        tm_clk_oe &lt;= '0'; -- CLK 'H'
                        tm_dio_oe &lt;= '0'; -- DIO 'H'
                        IF START = '1' THEN
                            state &lt;= ST_START;
                        END IF;

                    WHEN ST_START =&gt;
                        DONE &lt;= '0';
                        stop_bit &lt;= STOP;
                        shift_reg &lt;= DC;
                        tm_dio_oe &lt;= '1'; -- DIO '0'
                        bit_cnt &lt;= 0;
                        state &lt;= ST_SHIFT_CLK_L;

                    WHEN ST_SHIFT_CLK_L =&gt;
                        tm_clk_oe &lt;= '1'; -- CLK '0'
                        state &lt;= ST_SHIFT_CLK_H;
                        tm_dio_oe &lt;= NOT shift_reg(0); -- LSB first
                        shift_reg &lt;= '0' &amp; shift_reg(7 DOWNTO 1);

                    WHEN ST_SHIFT_CLK_H =&gt;
                        tm_clk_oe &lt;= '0'; -- CLK 'H'
                        IF bit_cnt = 7 THEN
                            state &lt;= ST_ACK;
                        ELSE
                            bit_cnt &lt;= bit_cnt + 1;
                            state &lt;= ST_SHIFT_CLK_L;
                        END IF;

                    WHEN ST_ACK =&gt;
                        tm_clk_oe &lt;= '1'; -- CLK '0'
                        tm_dio_oe &lt;= '0'; -- release line
                        DONE &lt;= '1';
                        state &lt;= ST_READ_ACK;

                    WHEN ST_READ_ACK =&gt;
                        ack_bit &lt;= TM_DIO; -- read ACK
                        tm_dio_oe &lt;= '1'; -- DIO '0'
                        tm_clk_oe &lt;= '0'; -- CLK 'H'
                        state &lt;= ST_DONE;

                    WHEN ST_DONE =&gt;
                        tm_dio_oe &lt;= '1'; -- DIO '0'
                        tm_clk_oe &lt;= '1'; -- CLK '0'
                        state &lt;= ST_STOP;

                    WHEN ST_STOP =&gt;
                        IF stop_bit = '0' THEN
                            tm_clk_oe &lt;= '1'; -- CLK '0'
                            state &lt;= ST_START;
                        ELSE
                            tm_clk_oe &lt;= '0'; -- CLK 'H'
                            state &lt;= ST_IDLE;
                        END IF;

                    WHEN OTHERS =&gt;
                        state &lt;= ST_IDLE;

                END CASE;
            END IF;
        END IF;
    END PROCESS;

END behavioral;
</code></pre>
<p>&nbsp;</p>
<p>This VHDL module demonstrates how to control a 4-digit 7-segment display 
using the TM1637 driver IC.
It instantiates a lower-level module (<code>tm1637_driver</code>) to manage 
the serial communication protocol, and implements a simple decimal counter 
(ranging from 0 to 9999) that updates periodically.
The counter value is converted to 7-segment format and sent 
to the TM1637 display module.</p>
<pre><code class="language-VHDL">-- File: tm1637_driver_demo.vhd
LIBRARY IEEE;
USE IEEE.STD_LOGIC_1164.ALL;
USE IEEE.NUMERIC_STD.ALL;

ENTITY tm1637_driver_demo IS
    PORT (
        CLK    : IN STD_LOGIC;
        RST_N  : IN STD_LOGIC;
        TM_CLK : INOUT STD_LOGIC;
        TM_DIO : INOUT STD_LOGIC
    );
END tm1637_driver_demo;

ARCHITECTURE behavioral OF tm1637_driver_demo IS

    -- TM1637 driver interface
    SIGNAL start : STD_LOGIC := '0';
    SIGNAL stop  : STD_LOGIC := '1';
    SIGNAL done  : STD_LOGIC;
    SIGNAL ack   : STD_LOGIC;
    SIGNAL dc    : STD_LOGIC_VECTOR(7 DOWNTO 0); -- DATA / CMD byte

    -- FSM
    TYPE state_type IS (
       ST_INIT, ST_LOAD, ST_SEND, ST_WAIT_START, ST_WAIT_DONE, ST_DELAY
    );

    SIGNAL state : state_type := ST_INIT;
    SIGNAL index : INTEGER RANGE 0 TO 6 := 0;

    CONSTANT DELAY_CNT_MAX : INTEGER := 5_000_000 - 1;
    SIGNAL delay_cnt : INTEGER RANGE 0 TO DELAY_CNT_MAX := 0;

    -- Counter for display
    SIGNAL count  : INTEGER RANGE 0 TO 9999 := 0;
    SIGNAL digit0 : INTEGER RANGE 0 TO 9 := 0; -- Units
    SIGNAL digit1 : INTEGER RANGE 0 TO 9 := 0; -- Tens
    SIGNAL digit2 : INTEGER RANGE 0 TO 9 := 0; -- Hundreds
    SIGNAL digit3 : INTEGER RANGE 0 TO 9 := 0; -- Thousands

    -- TM1637 data sequence (7 commands total)
    TYPE data_array IS ARRAY (0 TO 6) OF STD_LOGIC_VECTOR(7 DOWNTO 0);
    SIGNAL data_seq : data_array;

    -- 7-segment encoding function
    FUNCTION to_7seg(val : INTEGER) RETURN STD_LOGIC_VECTOR IS
    BEGIN
        CASE val IS
            WHEN 0 =&gt; RETURN &quot;00111111&quot;;
            WHEN 1 =&gt; RETURN &quot;00000110&quot;;
            WHEN 2 =&gt; RETURN &quot;01011011&quot;;
            WHEN 3 =&gt; RETURN &quot;01001111&quot;;
            WHEN 4 =&gt; RETURN &quot;01100110&quot;;
            WHEN 5 =&gt; RETURN &quot;01101101&quot;;
            WHEN 6 =&gt; RETURN &quot;01111101&quot;;
            WHEN 7 =&gt; RETURN &quot;00000111&quot;;
            WHEN 8 =&gt; RETURN &quot;01111111&quot;;
            WHEN 9 =&gt; RETURN &quot;01101111&quot;;
            WHEN OTHERS =&gt; RETURN &quot;00000000&quot;;
        END CASE;
    END FUNCTION;

BEGIN
    -- TM1637 Driver Instance
    driver_inst : ENTITY work.tm1637_driver
        PORT MAP(
            CLK    =&gt; CLK,
            RST_N  =&gt; RST_N,
            START  =&gt; start,
            STOP   =&gt; stop,
            DC     =&gt; dc,
            TM_CLK =&gt; TM_CLK,
            TM_DIO =&gt; TM_DIO,
            DONE   =&gt; done,
            ACK =&gt; ack
        );

    -- FSM Process
    PROCESS (CLK, RST_N)
    BEGIN
        IF RST_N = '0' THEN
            state &lt;= ST_INIT;
            start &lt;= '0';
            stop  &lt;= '1';
            index &lt;= 0;
            delay_cnt &lt;= 0;
            count &lt;= 0;

        ELSIF rising_edge(CLK) THEN
            CASE state IS

                WHEN ST_INIT =&gt;
                    start &lt;= '0';
                    stop  &lt;= '1';
                    index &lt;= 0;
                    state &lt;= ST_LOAD;

                WHEN ST_LOAD =&gt;
                    -- Split count into BCD digits
                    digit0 &lt;= count MOD 10;
                    digit1 &lt;= (count / 10) MOD 10;
                    digit2 &lt;= (count / 100) MOD 10;
                    digit3 &lt;= (count / 1000) MOD 10;

                    -- Prepare TM1637 command/data sequence
                    data_seq(0) &lt;= x&quot;40&quot;; -- CMD1: normal write
                    data_seq(1) &lt;= x&quot;C0&quot;; -- CMD2: start address
                    data_seq(2) &lt;= to_7seg(digit3); -- leftmost digit
                    data_seq(3) &lt;= to_7seg(digit2);
                    data_seq(4) &lt;= to_7seg(digit1);
                    data_seq(5) &lt;= to_7seg(digit0); -- rightmost digit        
                    data_seq(6) &lt;= x&quot;8F&quot;; -- CMD3: display ON (max. brightness)

                    state &lt;= ST_SEND;

                WHEN ST_SEND =&gt;
                    dc &lt;= data_seq(index);
                    start &lt;= '1';

                    -- Only stop for command or last byte
                    IF index = 0 OR index = 5 OR index = 6 THEN
                        stop &lt;= '1';
                    ELSE
                        stop &lt;= '0';
                    END IF;

                    state &lt;= ST_WAIT_START;

                WHEN ST_WAIT_START =&gt;
                    IF done = '0' THEN
                        start &lt;= '0';
                        state &lt;= ST_WAIT_DONE;
                    END IF;

                WHEN ST_WAIT_DONE =&gt;
                    IF done = '1' THEN
                        IF index = 6 THEN
                            state &lt;= ST_DELAY;
                            delay_cnt &lt;= DELAY_CNT_MAX;
                        ELSE
                            index &lt;= index + 1;
                            state &lt;= ST_SEND;
                        END IF;
                    END IF;

                WHEN ST_DELAY =&gt;
                    IF delay_cnt = 0 THEN
                        IF count = 9999 THEN
                            count &lt;= 0;
                        ELSE
                            count &lt;= count + 1;
                        END IF;
                        state &lt;= ST_INIT;
                    ELSE
                        delay_cnt &lt;= delay_cnt - 1;
                    END IF;

                WHEN OTHERS =&gt;
                    state &lt;= ST_INIT;

            END CASE;
        END IF;
    END PROCESS;

END behavioral;
</code></pre>
<p>&nbsp;</p>
<p>The following Tcl script defines the pin assignments for the DE10-Lite FPGA board.</p>
<pre><code class="language-tcl"># File: assignments.tcl
#============================================================
# CLOCK (MAX10_CLK1_50)
#============================================================
set_instance_assignment -name IO_STANDARD &quot;3.3-V LVTTL&quot; -to CLK
set_location_assignment PIN_P11 -to CLK

#============================================================
# Push Buttons (KEY)
#============================================================

set_instance_assignment -name IO_STANDARD &quot;3.3 V SCHMITT TRIGGER&quot; -to RST_N
set_location_assignment PIN_B8 -to RST_N

#============================================================
# Arduino I/O 14 &amp; 15 
#============================================================

set_instance_assignment -name IO_STANDARD &quot;3.3-V LVTTL&quot; -to TM_CLK
set_instance_assignment -name IO_STANDARD &quot;3.3-V LVTTL&quot; -to TM_DIO
set_location_assignment PIN_AB21 -to TM_CLK
set_location_assignment PIN_AA20 -to TM_DIO

#set_instance_assignment -name WEAK_PULL_UP_RESISTOR ON -to TM_CLK
#set_instance_assignment -name WEAK_PULL_UP_RESISTOR ON -to TM_DIO

#============================================================
</code></pre>
<p>The following are the sample waveforms of <code>CLK</code> and <code>DIO</code>
measured by a digital oscilloscope.</p>
<p><img alt="" src="waveform-1.jpg" /></p>
<p><img alt="" src="waveform-2.jpg" /></p>
<p><strong>Figure:</strong> Waveforms measured by a digital oscilloscope</p>
<p>The following are sample waveforms of the CLK and DIO signals,
captured using a digital oscilloscope.</p>
<p>Note that the clock rate of the TM1637 interface is limited (<strong>up to 450kHz</strong>),
and it also depends on the values of the pull-up resistors and 
any filtering capacitors used on the lines.</p>
<p><img alt="" src="fpga_tm1637_demo.jpg" /></p>
<p><strong>Figure:</strong> DE10 Lite FPGA board + TM1637-based 7-segment 4-digit display module</p>
<hr />
<p><em>This work is licensed under a</em> <strong><em>Creative Commons Attribution-ShareAlike 4.0 International License</em></strong>.</p>
<p>Created: 2025-06-18 | Last Updated: 2025-06-18</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2021-2025 IoT Engineering Education, Bangkok/Thailand</a></p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../js/base.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script src="../../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
