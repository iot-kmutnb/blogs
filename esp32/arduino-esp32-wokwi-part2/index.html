<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="RSP">
        <link rel="canonical" href="http://iot-kmutnb.github.com/blogs/esp32/arduino-esp32-wokwi-part2/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>การเขียนไมโครคอนโทรลเลอร์ Arduino-ESP32 ด้วย Wokwi Simulator (ตอนที่ 2) - IoT Engineering Education</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
        <link href="../../css/extra.css" rel="stylesheet">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/c.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/cpp.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/arduino.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/javascript.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/typescript.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/json.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/rust.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/vhdl.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/verilog.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/bash.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/text.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/matlab.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/julia.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-966FQ6RN6W"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'G-966FQ6RN6W');
        </script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">IoT Engineering Education</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="../../about/" class="nav-link">About</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#arduino-esp32-wokwi-simulator-2" class="nav-link">การเขียนไมโครคอนโทรลเลอร์ Arduino-ESP32 ด้วย Wokwi Simulator (ตอนที่ 2)</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#wokwi-electronic-components" class="nav-link">&#9655; Wokwi - Electronic Components</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#led-push-button" class="nav-link">&#9655; LED + Push Button</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_1" class="nav-link">&#9655; กล่าวสรุป</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="arduino-esp32-wokwi-simulator-2">การเขียนไมโครคอนโทรลเลอร์ Arduino-ESP32 ด้วย Wokwi Simulator (ตอนที่ 2)<a class="headerlink" href="#arduino-esp32-wokwi-simulator-2" title="Permanent link">#</a></h1>
<hr />
<h2 id="wokwi-electronic-components">&#9655; <strong>Wokwi - Electronic Components</strong><a class="headerlink" href="#wokwi-electronic-components" title="Permanent link">#</a></h2>
<p>บทความนี้นำเสนอซอฟต์แวร์ <strong>Wokwi Online Simulator</strong>
สำหรับการเขียนโค้ดด้วยภาษา <strong>C/C++</strong> 
และสร้างวงจรเสมือนจริงที่มีบอร์ดไมโครคอนโทรลเลอร์ <strong>ESP32</strong> และอุปกรณ์อิเล็กทรอนิกส์พื้นฐานต่าง ๆ</p>
<p>นอกจากบอร์ดไมโครคอนโทรลเลอร์ที่มีให้เลือกใช้งานได้หลายแบบแล้ว
ยังมีรายการอุปกรณ์ชิ้นส่วนหรือโมดูลอิเล็กทรอนิกส์อีกหลายประเภท ให้เลือกใช้งานได้
และนำมาต่อวงจรเสมือนจริง</p>
<p><img alt="" src="wowki_esp32.png" /></p>
<p>รูป: เริ่มต้นโปรเจกต์ใหม่ใน <strong>Wokwi Online Simulator</strong> โดยเลือกใช้บอร์ด <strong>ESP32</strong> </p>
<p>ถ้าต้องการเพิ่มอุปกรณ์อิเล็กทรนิกส์จากรายการ เพื่อนำมาต่อใช้งานเสมือนจริงกับบอร์ด
<strong>ESP32</strong> ก็ให้กดปุ่ม <strong>(+)</strong> เพื่อเลือกอุปกรณ์</p>
<p><img alt="" src="wokwi_add_components.png" /></p>
<p>รูป: รายการอุปกรณ์อิเล็กทรอนิกส์ใน <strong>Wokwi Online Simulator</strong></p>
<p><img alt="" src="wokwi_components_list.png" /></p>
<p>รูป: รายการอุปกรณ์อิเล็กทรอนิกส์ที่สามารถเลือกใช้ได้</p>
<p><strong>ข้อสังเกต:</strong> แม้ว่า <strong>Wokwi Simulator</strong> สามารถจำลองการทำงานของวงจรอิเล็กทรอนิกส์ได้ 
แต่มีข้อจำกัดในการจำลองการทำงานของวงจรอิเล็กทรอนิกส์แบบแอนะล็อก 
(เนื่องจากไม่ได้ใช้ตัวจำลองการทำงานของวงจรด้วย <strong>SPICE Circuit Simulator</strong>)</p>
<p>&nbsp;</p>
<hr />
<h2 id="led-push-button">&#9655; <strong>LED + Push Button</strong><a class="headerlink" href="#led-push-button" title="Permanent link">#</a></h2>
<p>ถัดไปลองมาดูตัวอย่างการต่อวงจร <strong>LED</strong> และปุ่มกด (<strong>Push Button</strong>) พร้อมตัวต้านทาน 
เพื่อใช้งานร่วมกับบอร์ด <strong>ESP32</strong></p>
<p><img alt="" src="wokwi_esp32_led_button_resistors-1.png" /></p>
<p>รูป: ตัวอย่างการเลือกอุปกรณ์มาต่อวงจรร่วมกับบอร์ด <strong>ESP32</strong></p>
<p>ถ้าหากดูรายการในไฟล์ <code>diagram.json</code> ของโปรเจกต์ ในส่วนที่เรียกว่า
<code>"parts": [ ... ]</code> จะเห็นรายการอุปกรณ์ที่ได้เลือกมาต่อวงจร
ซึ่งภายในเป็นข้อความแบบ <strong>JSON String Format</strong></p>
<p>จากรูปตัวอย่าง อุปกรณ์ <code>"wokwi-led"</code> มี <code>"id"</code> (<strong>Instance ID</strong>) 
เท่ากับ <code>"led1"</code> มีพิกัดหรือตำแหน่งสำหรับการวาดรูป <code>"top"</code> และ <code>"left"</code>
ในบริเวณที่เป็น <strong>Drawing Canvas</strong>
และมี <code>"attrs"</code> สำหรับรายการคุณสมบัติของอุปกรณ์ เช่น <code>"color"</code> ที่มีค่าเท่ากับ
<code>"red"</code> ซึ่งหมายถึง หลอดแอลอีดี (5mm.) มีสีแดง เป็นต้น</p>
<p>อุปกรณ์ <code>"wokwi-pushbutton"</code> มี <code>"id"</code> (<strong>Instance ID</strong>) 
เท่ากับ <code>"btn1"</code> มีพิกัดหรือตำแหน่งสำหรับการวาดรูปในบริเวณที่เป็น <strong>Drawing Canvas</strong> 
ที่ถูกกำหนดโดย <code>"top"</code> และ <code>"left"</code> และมี <code>"attrs"</code>
สำหรับรายการคุณสมบัติเฉพาะสำหรับแต่ละอุปกรณ์
เช่น <code>"color"</code> ที่มีค่าเท่ากับ
<code>"green"</code> ซึ่งหมายถึง ปุ่มกด (<strong>12mm. Tactile Switch</strong>) มีสีเขียว เป็นต้น</p>
<pre><code class="language-json">{
      &quot;type&quot;: &quot;wokwi-led&quot;,
      &quot;id&quot;: &quot;led1&quot;,
      &quot;top&quot;: -64.48,
      &quot;left&quot;: -162.47,
      &quot;attrs&quot;: { &quot;color&quot;: &quot;red&quot; }
},
{
      &quot;type&quot;: &quot;wokwi-pushbutton&quot;,
      &quot;id&quot;: &quot;btn1&quot;,
      &quot;top&quot;: 17.96,
      &quot;left&quot;: -177.91,
      &quot;attrs&quot;: { &quot;color&quot;: &quot;green&quot; }
},
</code></pre>
<p>&nbsp;</p>
<p>นอกจากนั้นยังมีตัวต้านทาน <code>"wokwi-resistor"</code> อีกสองตัว ได้แก่
<code>"id"</code> เท่ากับ <code>"r1"</code> และ <code>"r2"</code> ตามลำดับ
และมีการกำหนดค่าให้สำหรับ <code>"value"</code> เท่ากับ <code>"1000"</code> (โอห์ม) ซึ่งจะใช้เป็นตัวต้านทานจำกัดกระแสสำหรับ <strong>LED</strong>
และ  <code>"10000"</code> (โอห์ม) ซึ่งจะใช้สำหรับเป็นตัวต้านทานแบบ <strong>Pullup</strong> สำหรับปุ่มกด 
และมีการหมุน <code>"rotate"</code> เป็นองศาเท่ากับ <code>0</code> และ <code>90</code> ตามลำดับ </p>
<pre><code class="language-json">{
      &quot;type&quot;: &quot;wokwi-resistor&quot;,
      &quot;id&quot;: &quot;r1&quot;,
      &quot;top&quot;: -39.15,
      &quot;left&quot;: -92.53,
      &quot;rotate&quot;: 0,
      &quot;attrs&quot;: { &quot;value&quot;: &quot;1000&quot; }
},
{
      &quot;type&quot;: &quot;wokwi-resistor&quot;,
      &quot;id&quot;: &quot;r2&quot;,
      &quot;rotate&quot;: 90,
      &quot;top&quot;: 36.33,
      &quot;left&quot;: -86.46,
      &quot;attrs&quot;: { &quot;value&quot;: &quot;10000&quot; }
}
</code></pre>
<p>รายละเอียดเพิ่มเติมสำหรับการใช้งานอุปกรณ์ทั้งสามประเภท สามารถดูได้จาก</p>
<ul>
<li><a href="https://docs.wokwi.com/parts/wokwi-led"><strong>"wokwi-led" Reference</strong></a></li>
<li><a href="https://docs.wokwi.com/parts/wokwi-pushbutton"><strong>"wokwi-pushbutton" Reference</strong></a></li>
<li><a href="https://docs.wokwi.com/parts/wokwi-resistor"><strong>"wokwi-resistor" Reference</strong></a></li>
</ul>
<p>เมื่อได้เลือกอุปกรณ์ต่าง ๆ มาวางในพื้นที่วาดรูปวงจรแล้ว ถัดไปเป็นการลากสายสัญญาณหรือสายไฟ
เพื่อเชื่อมต่อขาของอุปกรณ์ให้เป็นวงจรที่ถูกต้อง ใช้เมาส์คลิกเลือกขาที่เป็นจุดเริ่มต้นแล้วเลื่อนไปยังตำแหน่งของ
ขาของอุปกรณ์ปลายทาง ตามรูปตัวอย่างดังนี้</p>
<p><img alt="" src="wokwi_esp32_led_button_resistors-2.png" /></p>
<p>รูป: ตัวอย่างการเชื่อมต่อขาของอุปกรณ์ต่าง ๆ ให้เป็นวงจร (<strong>Wiring</strong>)</p>
<p>ถ้าลองดูในไฟล์ <code>diagram.json</code> ของโปรเจกต์ จะเห็นว่า มีส่วนที่มีชื่อว่า  <code>"connections"</code> 
ซึ่งมีข้อความตัวอย่างดังนี้</p>
<pre><code class="language-json">{
 &quot;connections&quot;: [
    [ &quot;esp:TX0&quot;, &quot;$serialMonitor:RX&quot;, &quot;&quot;, [] ],
    [ &quot;esp:RX0&quot;, &quot;$serialMonitor:TX&quot;, &quot;&quot;, [] ],
    [ &quot;esp:D4&quot;, &quot;led1:A&quot;, &quot;green&quot;, [ &quot;h159.26&quot;, &quot;v58.52&quot;, &quot;h-26.45&quot; ] ],
    [ &quot;led1:C&quot;, &quot;r1:2&quot;, &quot;green&quot;, [ &quot;v0&quot; ] ],
    [ &quot;r1:1&quot;, &quot;esp:GND.1&quot;, &quot;black&quot;, [ &quot;v0.69&quot;, &quot;h-16.83&quot;, &quot;v-30.14&quot; ] ],
    [ &quot;esp:3V3&quot;, &quot;r2:1&quot;, &quot;red&quot;, [ &quot;v-0.07&quot;, &quot;h19.89&quot;, &quot;v42.06&quot;, &quot;h188.97&quot;, &quot;v-200.9&quot; ] ],
    [ &quot;r2:2&quot;, &quot;btn1:1.l&quot;, &quot;green&quot;, [ &quot;v0.69&quot;, &quot;h-15.8&quot; ] ],
    [ &quot;btn1:2.r&quot;, &quot;esp:GND.1&quot;, &quot;black&quot;, [ &quot;v0&quot; ] ],
    [ &quot;esp:D5&quot;, &quot;btn1:1.l&quot;, &quot;green&quot;, [ &quot;h68.23&quot;, &quot;v-92.96&quot;, &quot;h-1.88&quot; ] ]
  ]
}
</code></pre>
<p>เมื่อต่อวงจรได้ครบถ้วนแล้ว ถัดไปลองเขียนโค้ดตามตัวอย่างต่อไปนี้ โดยมีขั้นตอนการทำงานดังนี้</p>
<ul>
<li>ขา <strong>LED_PIN</strong> และ <strong>BTN_PIN</strong> เป็นขา <strong>4</strong> (D4) และ <strong>5</strong> (D5) บนบอร์ด <strong>ESP32</strong></li>
<li>คำสั่ง <code>pinMode( LED_PIN, OUTPUT );</code> ทำให้ขา <code>LED_PIN</code> เป็นเอาต์พุตแบบดิจิทัล</li>
<li>คำสั่ง <code>pinMode( BTN_PIN, INPUT  );</code> ทำให้ขา <code>BTN_PIN</code> เป็นขาอินพุตแบบดิจิทัล</li>
<li>คำสั่ง <code>digitalWrite( LED_PIN, !digitalRead( BTN_PIN) );</code>
ทำหน้าที่คอยอ่านค่าลอจิกจากขา <code>BTN_PIN</code> เป็นอินพุต
เมื่อได้ค่ามาแล้ว ก็นำมากลับค่าลอจิก ก่อนนำไปใช้กำหนดค่าลอจิกที่ขา <code>LED_PIN</code> เป็นเอาต์พุต
ประโยคคำสั่งนี้อยู่ในฟังก์ชัน <code>loop()</code> ดังนั้นจึงมีการทำซ้ำไปเรื่อย ๆ โดยเว้นระยะเวลา
10 มิลลิวินาที ด้วยคำสั่ง <code>delay(10)</code> ก่อนทำซ้ำในแต่ละครั้ง</li>
</ul>
<pre><code>const int LED_PIN = 4; // D4 pin
const int BTN_PIN = 5; // D5 pin

void setup() {
  Serial.begin(115200);
  pinMode( LED_PIN, OUTPUT );
  pinMode( BTN_PIN, INPUT  );
}

void loop() {
  // Read the input value from the button pin,
  // write the inverted input value to the output LED pin.
  digitalWrite( LED_PIN, !digitalRead( BTN_PIN) );
  delay(10);
}
</code></pre>
<p><img alt="" src="wokwi_esp32_led_button_resistors-3.png" /></p>
<p>รูป: การจำลองการทำงานของวงจรและโค้ดที่ได้เขียนไว้</p>
<p>&nbsp;</p>
<hr />
<h2 id="_1">&#9655; <strong>กล่าวสรุป</strong><a class="headerlink" href="#_1" title="Permanent link">#</a></h2>
<p>บทความนี้นำเสนอการใช้งาน <strong>Wokwi Online Arduino Simulator</strong> 
เพื่อการทดลองเขียนโค้ด <strong>Arduino Sketch</strong> และทดลองต่อวงจรโดยใช้ <strong>LED</strong>
และปุ่มกดแบบเสมือนจริง และจำลองการทำงานของโค้ดสำหรับบอร์ดไมโครคอนโทรลเลอร์
<strong>ESP32</strong> </p>
<p>&nbsp;</p>
<hr />
<p>This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International License.</p>
<p>Created: 2022-11-13 | Last Updated: 2022-11-14</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2021-2022 IoT Engineering Education, Bangkok/Thailand</a></p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
