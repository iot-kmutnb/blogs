<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="RSP">
        <link rel="canonical" href="http://iot-kmutnb.github.com/blogs/esp32/arduino-esp32-wokwi-part1/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>การเขียนโปรแกรมไมโครคอนโทรลเลอร์ Arduino-ESP32 ด้วย Wokwi Simulator (ตอนที่ 1) - IoT Engineering Education</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
        <link href="../../css/extra.css" rel="stylesheet">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/c.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/cpp.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/arduino.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/javascript.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/typescript.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/json.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/rust.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/vhdl.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/verilog.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/bash.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/text.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/matlab.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/julia.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-966FQ6RN6W"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'G-966FQ6RN6W');
        </script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">IoT Engineering Education</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="../../about/" class="nav-link">About</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#arduino-esp32-wokwi-simulator-1" class="nav-link">การเขียนโปรแกรมไมโครคอนโทรลเลอร์ Arduino-ESP32 ด้วย Wokwi Simulator (ตอนที่ 1)</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#arduino-esp32-wokwi" class="nav-link">&#9655; Arduino - ESP32 - Wokwi</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#arduino" class="nav-link">Arduino</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#esp32" class="nav-link">ESP32</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#wokwi" class="nav-link">Wokwi</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#wokwi-simulator-esp32" class="nav-link">การเริ่มต้นสร้างโปรเจกต์ใหม่ใน Wokwi Simulator สำหรับ ESP32</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_1" class="nav-link">&#9655; กล่าวสรุป</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="arduino-esp32-wokwi-simulator-1">การเขียนโปรแกรมไมโครคอนโทรลเลอร์ Arduino-ESP32 ด้วย Wokwi Simulator (ตอนที่ 1)<a class="headerlink" href="#arduino-esp32-wokwi-simulator-1" title="Permanent link">#</a></h1>
<hr />
<h2 id="arduino-esp32-wokwi">&#9655; <strong>Arduino - ESP32 - Wokwi</strong><a class="headerlink" href="#arduino-esp32-wokwi" title="Permanent link">#</a></h2>
<p>บทความนี้นำเสนอซอฟต์แวร์ <strong>Wokwi Online Simulator</strong>
สำหรับการเขียนโค้ดด้วยภาษา <strong>C/C++</strong> ตามรูปแบบของ <strong>Arduino</strong>
โดยเลือกใช้บอร์ดไมโครคอนโทรลเลอร์ <strong>ESP32</strong> สำหรับการสาธิต
และตรวจสอบการทำงานของโค้ดด้วยวิธีการจำลองการทำงานบนหน้าเว็บเบราว์เซอร์ </p>
<p>ก่อนอื่นมาทำความรู้จักกับสามสิ่งต่อไปนี้</p>
<ol>
<li><strong>Arduino</strong></li>
<li><strong>ESP32</strong></li>
<li><strong>Wokwi</strong></li>
</ol>
<h3 id="arduino"><strong>Arduino</strong><a class="headerlink" href="#arduino" title="Permanent link">#</a></h3>
<p><a href="https://www.arduino.cc/"><strong>Arduino</strong></a> หมายรวมถึง การกำหนดรูปแบบในการเขียนโปรแกรมด้วยภาษา <strong>C/C++</strong> เรียกว่า
<a href="https://www.arduino.cc/reference/en/"><strong>Arduino API</strong></a> (<em>Application Programmiong Interface</em>)
หรือ อาจเรียกว่า <strong>Arduino Language Reference</strong> 
โปรแกรมหรือโค้ดที่เป็นไปตามรูปแบบของ <strong>Arduino</strong> สามารถนำไปคอมไพล์แล้วนำไปอัปโหลดไปยังบอร์ด
<strong>Arduino</strong> จะถูกเรียกว่า <strong>Arduino Sketch</strong></p>
<p>ซอฟต์แวร์ของ <strong>Arduino</strong> มีหลายรูปแบบ และใช้สำหรับการพัฒนาระบบสมองกลฝังตัว (<strong>Embedded Systems</strong>) 
ที่มีชิปไมโครคอนโทรลเลอร์เป็นตัวประมวลผล โดยทั่วไปก็จัดอยู่ในประเภท <strong>Open Source</strong> 
มีการแชร์โค้ดไว้ใน <a href="https://github.com/arduino/"><strong>Github</strong></a> เช่น <a href="https://docs.arduino.cc/software/"><strong>Arduino IDE</strong></a>,
<a href="https://docs.arduino.cc/learn/starting-guide/cores"><strong>Arduino Cores</strong></a>, 
<a href="https://www.arduino.cc/reference/en/libraries/"><strong>Arduino Libraries</strong></a>
และซอฟต์แวร์ที่มีการให้บริการในระบบ <a href="https://cloud.arduino.cc/"><strong>Arduino Cloud</strong></a>
นอกจากซอฟต์แวร์แล้ว ยังมีส่วนที่เป็นฮาร์ดแวร์ซึ่งรองรับการเขียนโปรแกรมตามรูปแบบของ <strong>Arduino API</strong>
และมีการเผยแพร่ไฟล์ในการออกแบบ หรือกล่าวได้ว่าเป็น <strong>Arduino-Compatible Open Hardware</strong></p>
<p>โดยทั่วไปแล้ว ฮาร์ดแวร์สำหรับ <strong>Arduino</strong> คือ  บอร์ดไมโครคอนโทรลเลอร์ที่มีการเลือกใช้ชิปตัวประมวลผลหลายรูปแบบ เช่น ขนาด 8 บิต
และ 32 บิต เป็นต้น ตัวอย่างบอร์ดที่มีตัวประมวลผล <strong>AVR (8-bit)</strong> ได้แก่ บอร์ด <strong>Arduino Uno</strong>, <strong>Nano</strong>, <strong>MEGA</strong> และบอร์ดที่มีตัวประมวลผล 32 บิต ได้แก่
<strong>Arduino MKR Family</strong>, <strong>Arduino Pro Portenta Family</strong> เป็นต้น
ในปัจจุบันก็มีบอร์ดไมโครคอนโทรลเลอร์จากนักพัฒนาหรือผู้ผลิตรายอื่นที่สามารถนำมาใช้
และเขียนโปรแกรมด้วยซอฟต์แวร์ตามรูปแบบของ <strong>Arduino</strong> ได้</p>
<p><strong>&rarr;</strong> แนะนำให้อ่านบทความเกี่ยวกับ <strong>Arduino</strong> ได้จากบทความภาษาไทย:
<a href="../../arduino/"><strong>"Arduino &amp; Embedded Systems: อาร์ดุยโนสำหรับการเรียนรู้ระบบสมองกลฝังตัว"</strong></a></p>
<hr />
<h3 id="esp32"><strong>ESP32</strong><a class="headerlink" href="#esp32" title="Permanent link">#</a></h3>
<p><strong>ESP32</strong> เป็นชื่อชิปของบริษัท <a href="https://www.espressif.com/"><strong>Espressif Systems</strong></a> ในประเทศจีน
จัดอยู่ในประเภท <strong>SoC</strong> (<em>System-on-a-Chip</em>) หรืออาจจะมองว่าเป็นชิปไมโครคอนโทรลเลอร์ก็ได้ ภายในมีตัวประมวลผลหรือซีพียูขนาด 32 บิต </p>
<p>บริษัท <strong>Espressif Systems</strong> ได้พัฒนาชิปถัดจากรุ่น <strong>ESP32</strong> ออกมาอีกหลายรุ่น เช่น <strong>ESP32-S2</strong>, <strong>ESP32-S3</strong>,
<strong>ESP32-C3</strong> เป็นต้น จุดเด่นของชิป <strong>ESP32</strong> คือ 
ความสามารถในการเชื่อมต่อและสื่อสารผ่านเครือข่ายไร้สาย <strong>Wi-Fi</strong> และ <strong>BLE</strong> และสามารถเขียนโปรแกรมตามรูปแบบของ 
<strong>Arduino</strong> ดังนั้นจึงได้รับความนิยมอย่างมากสำหรับการใช้งานด้าน <strong>IoT (Internet of Things)</strong></p>
<p>สำหรับการเขียนโปรแกรม <strong>ESP32</strong> ด้วยภาษา <strong>C/C++</strong> ทางบริษัท <strong>Espressif Systems</strong> 
ได้พัฒนาซอฟต์แวร์และไลบรารีต่าง ๆ รวมเรียกว่า <a href="https://github.com/espressif/esp-idf"><strong>ESP-IDF</strong></a>
(<em>Espressif IoT Developmment Framework</em>) หรืออาจจะมองว่าเป็น <strong>SDK</strong> (<em>Software Development Kit</em>) สำหรับ <strong>ESP32</strong> และในขณะที่เขียนบทความนี้ 
เวอร์ชันในปัจจุบันของ <a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/versions.html"><strong>ESP-IDF</strong></a> คือ <strong>v4.4</strong>
และตามมาด้วย <strong>v5.0</strong> </p>
<p>แต่สำหรับผู้เริ่มต้น การใช้ <strong>ESP-IDF</strong> สำหรับการเขียนโปรแกรมชิปหรือบอร์ด <strong>ESP32</strong> 
ก็อาจยากกว่าการใช้ <strong>Arduino</strong> ดังนั้นถ้าต้องการเขียนโปรแกรมโดยใช้ <strong>Arduino IDE</strong>
ก็ให้ติดตั้งเพิ่มซอฟต์แวร์ที่เรียกว่า <a href="https://github.com/espressif/arduino-esp32"><strong>Arduino-ESP32 Core</strong></a> </p>
<p>อีกตัวเลือกหนึ่งคือ การใช้ภาษา <strong>Python</strong> 
เช่น <a href="https://micropython.org/download/esp32/"><strong>MicroPython</strong></a>
และ <a href="https://circuitpython.org/downloads?q=esp32"><strong>CircuitPython</strong></a> ซึ่งสามารถนำมาใช้กับชิป <strong>ESP32</strong> ได้เช่นกัน เหมาะสำหรับผู้ที่มีพื้นฐานการเขียนโปรแกรม <strong>Python</strong> มาบ้างแล้ว</p>
<p><strong>&rarr;</strong> อ่านบทความที่มีเนื้อหาเกี่ยวกับ <strong>Espressif ESP32</strong> 
ได้จากบทความภาษาไทย: <a href="../../esp32/"><strong>"แนะนำ Espressif ESP32 SoCs: ตัวเลือกสำหรับฮาร์ดแวร์และซอฟต์แวร์
"</strong></a></p>
<hr />
<h3 id="wokwi"><strong>Wokwi</strong><a class="headerlink" href="#wokwi" title="Permanent link">#</a></h3>
<p>&#10077;<em>Wokwi is an online microcontroller simulator built to make it easy to test different code types / platforms
like Arduino, MicroPython, Rust, C, and more!</em>&#10078; &mdash; Uri Shaked
(the creator of Wokwi)</p>
<p><a href="https://wokwi.com/"><strong>Wokwi - Online Simulator</strong></a></p>
<ul>
<li>เป็นโปรเจกต์ในการพัฒนาซอฟต์แวร์ เริ่มต้นในปีค.ศ. 2019 โดย <a href="https://il.linkedin.com/in/urishaked"><strong>Uri Shaked</strong></a> นักพัฒนาชาวอิสราเอล 
และเปิดให้บริการโดยบริษัท <strong>CodeMagic Ltd.</strong></li>
<li>จัดอยู่ในซอฟต์แวร์ประเภท <strong>Web App</strong> ใช้สำหรับการเขียนโค้ดและจำลองการทำงานของไมโครคอนโทรลเลอร์
เช่น บอร์ด <strong>Arduino Uno / Nano / MEGA</strong> และ บอร์ด <strong>ESP32</strong> เป็นต้น</li>
<li>ทำงานบนหน้าเว็บเบราว์เซอร์ของผู้ใช้ ดังนั้นจึงไม่จำเป็นต้องติดตั้งโปรแกรมใด ๆ ในเครื่องของผู้ใช้  </li>
</ul>
<p><img alt="" src="wokwi_web-1.png" /></p>
<p>รูป: หน้าเว็บไซต์ของ <strong>Wokwi</strong> และตัวอย่างโปรเจกต์สาธิต</p>
<p><img alt="" src="wokwi_web-2.png" /></p>
<p>รูป: ตัวเลือกบอร์ดไมโครคอนโทรลเลอร์สำหรับการสร้างโปรเจกต์ใหม่</p>
<p>ซอฟต์แวร์ที่เป็นองค์ประกอบสำคัญของโปรเจกต์ <strong>Wokwi</strong> ได้แก่</p>
<ul>
<li><a href="https://github.com/wokwi/avr8js"><strong>AVR8js JavaScript library</strong></a> 
ใช้ภาษา <strong>TypeScript / JavaScript</strong> สำหรับการพัฒนาตัวจำลองการทำงานของซิปไมโครคอนโทรลเลอร์ <strong>AVR</strong> หรือ เรียกว่า <strong>JavaScript-based
AVR Simulator</strong> ไลบรารีดังกล่าวซึ่งเป็น <strong>Open Source</strong> ถือว่าเป็นส่วนที่สำคัญสำหรับการทำงานของซอฟต์แวร์ 
<a href="https://wokwi.com/dashboard/projects"><strong>Wokwi Arduino Simulator</strong></a></li>
<li><a href="https://github.com/wokwi/wokwi-elements"><strong>Wokwi Elements</strong></a>
เป็น <strong>Graphical Web Components</strong> สำหรับอุปกรณ์อิเล็กทรอนิกส์ต่าง ๆ 
ที่สามารถนำมาสร้างวงจรเสมือนจริง (<strong>Virtual Circuit Prototyping</strong>) 
และจำลองการทำงานร่วมกันได้ (<strong>Interactive Simulation</strong>) เช่น บอร์ด <strong>Arduino</strong> หลอดแอลอีดี (<strong>LED</strong>) ปุ่มกด (<strong>Button</strong>) เป็นต้น<ul>
<li>ดูรายการอุปกรณ์ที่ใช้ได้กับ <strong>Wokwi Simulator</strong> ได้จากเว็บ <a href="https://elements.wokwi.com/">https://elements.wokwi.com/</a></li>
</ul>
</li>
<li>นอกจากซอฟต์แวร์ที่ทำหน้าที่จำลองการทำงานของซีพียูตามชุดคำสั่ง <strong>AVR</strong> หรือ <strong>AVR Simulator</strong>
ยังมีตัวจำลองการทำงานสำหรับตัวประมวลผลอื่นอีก ได้แก่<ul>
<li><strong>RP2040 Simulator</strong> ที่มีชื่อว่า <a href="https://github.com/wokwi/rp2040js"><code>rp2040js</code></a> เป็นซอฟต์แวร์ <strong>Open Source</strong>
และรองรับการรันคำสั่งโดยใช้เฟิร์มแวร์ของ <strong>MicroPython</strong> หรือ <strong>Circuit Python</strong> ได้</li>
<li><strong>ESP32 Simulator</strong> สำหรับชุดคำสั่งตามสถาปัตยกรรมของซีพียูที่มีชื่อว่า  <strong>Xtensa</strong> และ <strong>RISC-V</strong></li>
</ul>
</li>
</ul>
<p><img alt="" src="wokwi_elements_led.png" /></p>
<p>รูป:  <strong>Wokwi Elements: <a href="https://elements.wokwi.com/?path=/story/led--red">LED (Red)</a></strong></p>
<p><img alt="" src="wokwi_elements_button.png" /></p>
<p>รูป:  <strong>Wokwi Elements: <a href="https://elements.wokwi.com/?path=/story/pushbutton--green">Push Button (Green)</a></strong></p>
<p>ตัวอย่างบอร์ดไมโครคอนโทรลเลอร์ที่สามารถเลือกใช้ได้ใน <strong>Wokwi Simulator</strong> ได้แก่</p>
<ul>
<li><strong>ATmega328P</strong>: <code>wokwi-arduino-uno</code>, <code>wokwi-arduino-nano</code></li>
<li><strong>ATmega2560</strong>: <code>wokwi-arduino-mega</code></li>
<li><strong>ATtiny85</strong>: <code>wokwi-attiny85</code></li>
<li><strong>RP2040</strong>: <code>wokwi-pi-pico</code></li>
<li><strong>ESP32</strong>: <code>wokwi-esp32-devkit-v1</code> </li>
<li><strong>ESP32-S2</strong>: <code>wokwi-esp32-s2-devkitm-1</code></li>
<li><strong>ESP32-S3</strong>: <code>wokwi-esp32-s3-devkitc-1</code></li>
<li><strong>ESP32-C3</strong>: <code>wokwi-esp32-c3-devkitm-1</code></li>
</ul>
<p>&nbsp;</p>
<hr />
<h3 id="wokwi-simulator-esp32"><strong>การเริ่มต้นสร้างโปรเจกต์ใหม่ใน Wokwi Simulator สำหรับ ESP32</strong><a class="headerlink" href="#wokwi-simulator-esp32" title="Permanent link">#</a></h3>
<p>หากยังไม่เคยใช้งาน <strong>Wokwi</strong> มาก่อน แนะนำให้ทำขั้นตอน <strong>SIGN UP / SIGN IN</strong>
เพื่อสร้างบัญชีผู้ใช้ และสามารถเลือกใช้บัญชีผู้ใช้ที่มีอยู่แล้ว ได้แก่  <strong>Google</strong> หรือ <strong>Github</strong> หรือ <strong>Email</strong></p>
<p>เริ่มต้นด้วยการเปิดเว็บเบราว์เซอร์ไปยัง
<a href="https://wokwi.com/projects/"><strong>https://wokwi.com/projects/</strong></a>
กดคลิก <strong>"+NEW PROJECT"</strong> แล้วเลือก <strong>ESP32</strong> จากรายการบอร์ดไมโครคอนโทรลเลอร์
หรือไปยัง <a href="https://wokwi.com/projects/new/esp32]"><strong>https://wokwi.com/projects/new/esp32</strong></a>
ก็ได้</p>
<p><img alt="" src="wokwi_new_esp32.png" /></p>
<p>รูป: การสร้างโปรเจกต์ใหม่สำหรับบอร์ด <strong>ESP32</strong> และเขียนโปรแกรมด้วย <strong>Arduino-ESP32 Core</strong></p>
<p>เมื่อได้สร้างโปรเจกต์ใหม่แล้ว จะเห็นว่า มีการสร้างไฟล์สำหรับการเขียนโค้ดมาให้แล้ว แบ่งเป็น <strong>Tabs</strong> ดังนี้</p>
<ul>
<li><code>sketch.ino</code> เป็นไฟล์ <strong>Arduino Sketch (.ino)</strong> ซึ่งมีฟังก์ชัน <code>setup()</code> 
และ <code>loop()</code> มาให้แล้ว ผู้ใช้สามารถเขียนโค้ดเพิ่มหรือแก้ไขโค้ดได้ นอกจากนั้นยังสามารถตั้งชื่อไฟล์ใหม่ได้
ตามต้องการ (<strong>Rename</strong>)</li>
<li><code>diagram.json</code> เป็นไฟล์ <strong>.json</strong> ที่ระบุไว้ว่า 
ในโปรเจกต์มีการใช้ฮาร์ดแวร์ประเภทใดบ้างเป็นองค์ประกอบของวงจร พร้อมกำหนดคุณสมบัติขององค์ประกอบเหล่านั้น </li>
<li><strong>Library Manager</strong> เป็นส่วนที่ใช้สำหรับระบุว่า ต้องการนำเข้าไลบรารีของ <strong>Arduino</strong> ใดบ้าง
ด้วยวิธีการเพิ่มชื่อของไลบรารีเหล่านั้น เพื่อนำมาใช้ในโปรเจกต์</li>
</ul>
<p>จากรายการเมนู จะเห็นว่า มีคำสั่งดังนี้</p>
<ul>
<li><strong>"Format code"</strong> สำหรับการจัดรูปแบบโค้ด <strong>Arduino Sketch</strong> โดยอัตโนมัติ</li>
<li><strong>"Rename"</strong> การตั้งชื่อไฟล์ใหม่</li>
<li><strong>"Delete"</strong> การลบไฟล์ในโปรเจกต์</li>
<li><strong>"+New file..."</strong> การสร้างไฟล์ใหม่และเพิ่มเข้าไว้ในโปรเจกต์ เช่น การสร้างไฟล์ <code>.cpp</code> หรือ <code>.h</code> เป็นต้น</li>
<li><strong>"Upload file(s) ..."</strong> การอัปโหลดไฟล์ที่มีอยู่แล้วในเครื่องผู้ใช้ เข้ามาเพิ่มในโปรเจกต์</li>
</ul>
<p>นอกจากส่วนที่เกี่ยวข้องกับไฟล์ของโปรเจกต์ บริเวณทางขวามือ มีรูปบอร์ด <strong>ESP32</strong> เสมือนจริง 
มีปุ่มสีเขียว <strong>"Start the simulation"</strong> เพื่อเริ่มต้นหรือหยุดการจำลองการทำงานโค้ดแบบเสมือนจริง</p>
<p><img alt="" src="wokwi_esp32_rename.png" /></p>
<p>รูป: การตั้งชื่อใหม่สำหรับ <strong>Arduino Sketch</strong> แทนที่ชื่อเดิม <code>sketch.ino</code></p>
<p><img alt="" src="wokwi_esp32_diagram.png" /></p>
<p>รูป: ตัวอย่างไฟล์ <code>diagram.json</code> ของโปรเจกต์</p>
<p>ลองแก้ไขโค้ดตามโค้ดตัวอย่างต่อไปนี้ แล้วทำขั้นตอนจำลองการทำงานของโค้ดสำหรับบอร์ด <strong>ESP32</strong></p>
<pre><code>void setup() {
  // Initialize the Serial interface, set baudrate to 115200
  Serial.begin(115200);
  // Send a message to the Serial interface
  Serial.println(&quot;Hello, ESP32!&quot;);
  // Configure the onboard LED pin as output
  pinMode( LED_BUILTIN, OUTPUT );
}

void loop() {
  digitalWrite( LED_BUILTIN, HIGH ); // Turn LED on
  Serial.println( &quot;LED on&quot; );
  delay(500);
  digitalWrite( LED_BUILTIN, LOW  ); // Turn LED off
  Serial.println( &quot;LED off&quot; );
  delay(500);
}
</code></pre>
<p><strong>คำอธิบายโค้ด</strong></p>
<ul>
<li>โค้ดของ <strong>Arduino Sketch</strong> โดยทั่วไป จะต้องมีฟังก์ชันที่มีชื่อว่า <strong>setup()</strong>
และ <strong>loop()</strong> เมื่อโปรแกรมเริ่มต้นทำงาน จะเรียกฟังก์ชัน <strong>setup()</strong> ให้ทำงานก่อน
และทำเพียงรอบเดียว เมื่อจบแล้ว จึงทำคำสั่งต่าง ๆ ของฟังก์ชัน <strong>loop()</strong> และเมื่อจบหนึ่งรอบแล้ว
ก็จะทำฟังก์ชันดังกล่าวซ้ำไปเรื่อย ๆ </li>
<li><code>Serial.begin(115200);</code> เป็นการเริ่มต้นการทำงานของวงจรที่เรียกว่า <strong>UART</strong>
(<em>Universal Asynchronous Receiver/Transmitter</em>) ที่อยู่ภายใน <strong>ESP32</strong>
เพื่อใช้สำหรับการสื่อสารข้อมูลแบบบิตอนุกรม (<strong>Serial</strong>) ผ่านทางพอร์ต <strong>USB-to-Serial</strong> 
ของบอร์ด <strong>ESP32</strong> ทำให้สามารถรับหรือส่งข้อความระหว่างคอมพิวเตอร์ผู้ใช้กับบอร์ด <strong>ESP32</strong> ได้ในขณะโปรแกรมทำงาน</li>
<li><code>Serial.println("Hello, ESP32!");</code> เป็นคำสั่งที่ใช้ในการส่งข้อความ
จากบอร์ด <strong>ESP32</strong> ไปยังคอมพิวเตอร์ของผู้ใช้ผ่านทางพอร์ต <strong>USB-to-Serial</strong></li>
<li><code>pinMode(LED_BUILTIN, OUTPUT);</code> เป็นการกำหนดทิศทางของขา <strong>Digital I/O</strong>
ซึ่งต่อกับวงจร <strong>LED</strong> บนบอร์ด <strong>ESP32</strong> ให้เป็นเอาต์พุต และใช้กำหนดสถานะลอจิกของ <strong>LED</strong>
<code>LED_BUILTIN</code> เป็นชื่อหรือสัญลักษณ์ที่ใช้แทนหมายเลขขา  <strong>Digital I/O</strong>
ที่มีวงจร <strong>LED</strong> บนบอร์ด <strong>ESP32-DevKit-v1</strong>
ถ้าทำเพิ่มประโยคคำสั่ง <code>Serial.println(LED_BUILTIN);</code> จะแสดงค่าตัวเลขของ <code>LED_BUILTIN</code>
ได้เท่ากับ <code>2</code> ซึ่งหมายความว่า ขา <strong>I/O</strong> ของวงจร <strong>LED</strong> บนบอร์ด <strong>ESP32-DevKit-v1</strong> ตรงกับขา
<strong>GPIO-2</strong></li>
<li><code>digitalWrite( LED_BUILTIN, HIGH );</code> เป็นการกำหนดสถานะของ <strong>LED</strong>
บนบอร์ดผ่านทางขา <strong>Digital I/O</strong> เป็นลอจิก 1 (<strong>High</strong>)</li>
<li><code>digitalWrite( LED_BUILTIN, LOW );</code> เป็นการกำหนดสถานะของ <strong>LED</strong>
บนบอร์ดผ่านทางขา <strong>Digital I/O</strong> เป็นลอจิก 0 (<strong>Low</strong>)</li>
<li><code>delay(500);</code> เป็นการหน่วงเวลาการทำงาน 500 มิลลิวินาที หรือ 0.5 วินาที ก่อนทำคำสั่งที่อยู่ถัดไป</li>
</ul>
<p>ในส่วนของฟังก์ชัน <code>loop()</code> อาจเขียนโค้ดใหม่ให้สั้นลงได้ดังนี้</p>
<pre><code>void loop() {
  static bool state = false;
  // Toggle the LED status
  state = !state;
  digitalWrite( LED_BUILTIN, state );
  Serial.printf( &quot;LED %s\n&quot;, state ? &quot;on&quot; : &quot;off&quot; );
  delay(500);
}
</code></pre>
<p>หรือถ้าไม่ใช้คำสั่ง <code>delay()</code> ก็ทำได้ดังนี้</p>
<pre><code>void loop() {
  static uint32_t last_update = 0;
  static bool state = false;
  uint32_t now = millis();
  if (now - last_update &gt;= 500) { // Update every 500 msec
    // Save the last update timestamp
    last_update = now;
    // Toggle the LED status
    digitalWrite( LED_BUILTIN, state = !state );
    Serial.printf( &quot;LED %s\n&quot;, state ? &quot;on&quot; : &quot;off&quot; );
  }
}
</code></pre>
<p>&nbsp;</p>
<p>เอกสารสำหรับคำสั่งและการเขียนโค้ด <strong>Arduino</strong> สำหรับ <strong>ESP32</strong> สามารถศึกษาได้จาก: 
<a href="https://espressif-docs.readthedocs-hosted.com/projects/arduino-esp32/en/latest/index.html">"<strong>ESP32 Arduino Core’s documentation</strong>"</a>
และ <a href="https://docs.wokwi.com/guides/esp32">"<strong>Wokwi - ESP32 Simulation Guide</strong>"</a></p>
<p><img alt="" src="wokwi_esp32_sim.png" /></p>
<p>รูป: การจำลองการทำงานของโค้ดตัวอย่างสำหรับบอร์ด <strong>Espressif ESP32 DevKit</strong></p>
<p>จากผลการจำลองการทำงาน จะเห็นได้ว่า มีข้อความปรากฏซึ่งเกิดจากการคำสั่ง
<code>Serial.println()</code> และส่งข้อความจากการทำงานของ <strong>ESP32</strong></p>
<p><img alt="" src="wokwi_esp32c3_sim.png" /></p>
<p>รูป: การจำลองการทำงานของโค้ดตัวอย่างสำหรับบอร์ด <strong>Espressif ESP32-C3 Mini-1</strong></p>
<p><img alt="" src="wokwi_esp32s2_sim.png" /></p>
<p>รูป: การจำลองการทำงานของโค้ดตัวอย่างสำหรับบอร์ด <strong>Espressif ESP32-S2 DevKit</strong></p>
<p>&nbsp;</p>
<hr />
<h2 id="_1">&#9655; <strong>กล่าวสรุป</strong><a class="headerlink" href="#_1" title="Permanent link">#</a></h2>
<p>บทความนี้นำเสนอการใช้งาน <strong>Wokwi Online Arduino Simulator</strong> 
เพื่อการทดลองเขียนโค้ด <strong>Arduino Sketch</strong> ในเบื้องต้น และจำลองการทำงานของโค้ดสำหรับบอร์ดไมโครคอนโทรลเลอร์
<strong>ESP32</strong> </p>
<p>อ่านบทความ "การเขียนโปรแกรมไมโครคอนโทรลเลอร์ <strong>Arduino-ESP32</strong> ด้วย <strong>Wokwi Simulator</strong>":
<a href="../arduino-esp32-wokwi-part2/">ตอนที่ 2</a></p>
<p>&nbsp;</p>
<hr />
<p>This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International License.</p>
<p>Created: 2022-11-12 | Last Updated: 2023-01-07</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2021-2023 IoT Engineering Education, Bangkok/Thailand</a></p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
