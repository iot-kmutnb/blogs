<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="RSP">
        <link rel="canonical" href="https://iot-kmutnb.github.io/blogs/electronics/circuit_simulation_software/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>ซอฟต์แวร์สำหรับการจำลองและวิเคราะห์การทำงานของวงจรไฟฟ้า-อิเล็กทรอนิกส์ - IoT Engineering Education</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
        <link href="../../css/extra.css" rel="stylesheet">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/c.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/cpp.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/arduino.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/javascript.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/typescript.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/json.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/rust.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/vhdl.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/verilog.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/bash.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/text.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/matlab.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/julia.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-966FQ6RN6W"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'G-966FQ6RN6W');
        </script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">IoT Engineering Education</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="../../about/" class="nav-link">About</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#-" class="nav-link">ซอฟต์แวร์สำหรับการจำลองและวิเคราะห์การทำงานของวงจรไฟฟ้า-อิเล็กทรอนิกส์</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#circuit-simulation" class="nav-link">&#9655; Circuit Simulation</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#spice-based-circuit-simulation-software" class="nav-link">&#9655; SPICE-based Circuit Simulation Software</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#spice-netlist" class="nav-link">&#9655; SPICE Netlist</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#programming-approaches-to-circuit-simulation" class="nav-link">&#9655; Programming Approaches to Circuit Simulation</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_1" class="nav-link">&#9655; กล่าวสรุป</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="-">ซอฟต์แวร์สำหรับการจำลองและวิเคราะห์การทำงานของวงจรไฟฟ้า-อิเล็กทรอนิกส์<a class="headerlink" href="#-" title="Permanent link">#</a></h1>
<p>บทความนี้กล่าวถึง การใช้ซอฟต์แวร์เพื่อช่วยในการวิเคราะห์และจำลองการทำงานของวงจรไฟฟ้า-อิเล็กทรอนิกส์</p>
<p><strong>Keywords:</strong> <em>Electronic Design Automation (EDA)</em>, <em>Circuit Simulation</em>, <em>Analog and Mixed-Signal Circuit Simulators</em></p>
<hr />
<h2 id="circuit-simulation">&#9655; <strong>Circuit Simulation</strong><a class="headerlink" href="#circuit-simulation" title="Permanent link">#</a></h2>
<p>วงจรไฟฟ้าและอิเล็กทรอนิกส์ มีองค์ประกอบพื้นฐานหลายประเภท เช่น ตัวต้านทาน (<strong>Resistors: R</strong>)
ตัวเก็บประจุ (<strong>Capacitors: C</strong>) ตัวเหนี่ยวนำไฟฟ้า (<strong>Inductors: L</strong>) 
แหล่งจ่ายไฟฟ้า (<strong>Sources</strong>) รวมถึงอุปกรณ์อิเล็กทรอนิกส์ที่ถูกสร้างมาจากสารกึ่งตัวนำ (<strong>Semiconductor Devices</strong>) เช่น ไดโอด (<strong>Diodes</strong>) และ ทรานซิสเตอร์ (<strong>Transistors</strong>)
ซึ่งจำแนกได้หลายประเภทย่อย และไอซีต่าง ๆ เช่น ออปแอมป์ (<strong>Op-Amps</strong>)</p>
<p>ความซับซ้อนและความยากง่ายในการวิเคราะห์วงจรไฟฟ้า ก็ขึ้นอยู่กับจำนวนและประเภทของอุปกรณ์ที่นำมาใช้ในวงจร
รวมถึงฟังก์ชันการทำงานของอุปกรณ์เหล่านั้น เช่น ความสัมพันธ์ระหว่างปริมาณทางไฟฟ้า-แรงดันไฟฟ้าและกระแสไฟฟ้า
และคุณสมบัติของอุปกรณ์ที่มีความเป็นเชิงเส้นหรือไม่เป็นเชิงเส้น เป็นต้น ดังนั้นการวิเคราะห์โดยใช้ทฤษฎีวงจรไฟฟ้า
และวิธีการทางคณิตศาสตร์ จึงมีข้อจำกัด หากจะต้องทำด้วยวิธีที่เรียกว่า "<strong>Pencil &amp; Paper Calculation</strong>"
หรือ การคำนวณด้วยมือ</p>
<p>นอกเหนือจากวิธีการทดลองสร้างวงจรต้นแบบ (<strong>Circuit Prototyping</strong>)
เพื่อตรวจสอบการทำงานของวงจรหรือศึกษาพฤติกรรมของวงจร เช่น การต่อวงจรบนเบรดบอร์ด (<strong>Breadboard</strong>)
แล้ววัดสัญญาณทางไฟฟ้าด้วยเครื่องมือวัดประเภทต่าง ๆ การวาดผังวงจรและจำลองการทำงานของวงจรโดยใช้ซอฟต์แวร์
(<strong>Circuit Simulation Software</strong>) ก็ถือว่าเป็นอีกหนึ่งวิธีที่มีความสะดวกและมีการใช้งานแพร่หลาย
และในปัจจุบันก็มีซอฟต์แวร์ให้นำมาใช้ได้ฟรีอยู่หลายตัวเลือก </p>
<p>ประโยชน์ของการใช้ซอฟต์แวร์จำลองและวิเคราะห์การทำงานของวงจรไฟฟ้า-อิเล็กทรอนิกส์</p>
<ul>
<li>ช่วยในการศึกษาพฤติกรรมการทำงานของวงจร </li>
<li>ช่วยในการประเมินหรือวัดประสิทธิภาพในการทำงานของวงจรหรืออุปกรณ์อิเล็กทรอนิกส์ </li>
<li>สามารถออกแบบและจำลองการทำงานของวงจร ก่อนที่จะนำไปสร้างหรือผลิตฮาร์ดแวร์จริง เพื่อช่วยให้นักออกแบบมั่นใจว่า ได้ออกแบบวงจรที่ทำงานได้ตามข้อกำหนด มีการจำลองการทำงานของวงจรภายใต้เงื่อนไขต่าง ๆ เช่น การปรับเปลี่ยนพารามิเตอร์ของวงจรในช่วงที่กำหนดไว้</li>
<li>ช่วยในการค้นหาสาเหตุของปัญหาที่เกิดขึ้น หากวงจรที่ได้ออกแบบนั้นไม่เป็นไปตามข้อกำหนด</li>
</ul>
<p>หากพิจารณาการวิเคราะห์วงจรไฟฟ้าแบบเชิงเส้น (<strong>Linear Circuits</strong>) เป็นตัวอย่าง เช่น 
วงจรประเภท <strong>R L C</strong> รูปแบบของกิจกรรมอาจเป็นดังนี้</p>
<ul>
<li><strong>Level 1)</strong> เรียนรู้ทฤษฎีทางวงจรไฟฟ้า แล้วคำนวณด้วยมือสำหรับโจทย์แบบฝึกหัด และใช้เครื่องคิดเลขสำหรับการคำนวณ</li>
<li><strong>Level 2)</strong> เหมือน <strong>Level 1</strong> แต่มีการใช้ซอฟต์แวร์มาช่วยในการวิเคราะห์วงจร เช่น การจำลองการทำงาน การเปลี่ยนพารามิเตอร์ของวงจร เพื่อดูผลลัพธ์และแนวโน้มที่เกิดขึ้นหรือความเชื่อมโยงกันระหว่างปริมาณทางไฟฟ้าต่าง ๆ ในวงจร</li>
<li><strong>Level 3)</strong> เหมือน <strong>Level 2</strong> แต่มีการฝึกเขียนโปรแกรมโดยใช้ภาษาคอมพิวเตอร์ระดับสูง เพื่อช่วยในการทำวิเคราะห์วงจรและทำให้มีความเข้าใจมากขึ้น </li>
</ul>
<hr />
<h2 id="spice-based-circuit-simulation-software">&#9655; <strong>SPICE-based Circuit Simulation Software</strong><a class="headerlink" href="#spice-based-circuit-simulation-software" title="Permanent link">#</a></h2>
<p>ซอฟต์แวร์ในประเภทโปรแกรมช่วยวิเคราะห์การทำงานของวงจรไฟฟ้า มีพื้นฐานมาจาก <a href="https://en.wikipedia.org/wiki/SPICE"><strong>SPICE</strong></a>
(<em>Simulation Program with Integrated Circuit Emphasis</em>)
ซึ่งได้มีการพัฒนาเพื่อใช้ในการวิเคราะห์วงจรแบบแอนะล็อก มีใช้งานมาตั้งแต่ราวปีค.ศ.  1973 โดยนักวิจัยของมหาวิทยาลัย <strong>University of California at Berkeley (CA, USA)</strong>
และได้มีการพัฒนาต่อเนื่องจนกลายเป็นซอฟต์แวร์เชิงการค้า (<strong>Commercial Software</strong>) เช่น 
ซอฟต์แวร์ที่มีชื่อว่า <strong>PSPICE</strong> ของบริษัท <strong>MicroSim</strong> จัดอยู่ในประเภทของซอฟต์แวร์ที่เรียกว่า <strong>Analog &amp; Mixed-signal Simulation Software</strong> </p>
<p>ต่อมาบริษัทนี้ได้ถูกซื้อและรวมเข้ากับ <a href="https://www.orcad.com/about/orcad-history"><strong>OrCAD</strong></a> (ในปีค.ศ. 1997) ซึ่งเป็นผู้พัฒนาซอฟต์แวร์ <strong>OrCAD Schematic &amp; PCB Design Tools</strong> และอีกไม่กี่ปีต่อมา (ในปีค.ศ. 1999) <a href="https://www.orcad.com/products/orcad-pspice-designer/overview"><strong>OrCAD Capture &amp; PSpice</strong></a> ก็ได้ถูกซื้อไปโดยบริษัท <a href="https://www.cadence.com/"><strong>Cadence Design Systems</strong></a> และซอฟต์แวร์ถูกนำไปรวมเข้ากับซอฟต์แวร์ <strong>Cadence Allegro PCB Design &amp; Analysis Tools</strong> (ในปีค.ศ. 2005)</p>
<p>ตัวอย่างซอฟต์แวร์ที่เป็นตัวเลือกสำหรับการจำลองการทำงานของวงจร ได้แก่</p>
<ul>
<li><a href="https://www.analog.com/en/design-center/design-tools-and-calculators/ltspice-simulator.html"><strong>LTSpice</strong></a> พัฒนาโดยบริษัท <strong>Linear Technology</strong> ต่อมาถูกรวมเข้ากับบริษัท <strong>Analog Devices</strong> และได้เปิดให้ดาวน์โหลดใช้งานซอฟต์แวร์ได้ฟรี  </li>
<li><a href="https://www.ni.com/en-th/support/downloads/software-products/download.multisim.html"><strong>NI MultiSim</strong></a> ของบริษัท <strong>National Instruments (NI)</strong> แต่มีเวอร์ชันที่ทำงานแบบออนไลน์ให้ใช้ได้ฟรี <a href="https://www.multisim.com/"><strong>Multisim Live Online Circuit Simulator</strong></a>
แต่มีข้อจำกัดในการใช้งานอยู่บ้าง เช่น ขนาดของวงจร (<strong>Components per circuit</strong>)</li>
<li><a href="https://easyeda.com/"><strong>EasyEDA Designer</strong></a> เป็นซอฟต์แวร์สำหรับการออกแบบวงจรและวาดลายวงจร แต่สามารถจำลองการทำงานของวงจรได้ โดยใช้ <strong>Ngspice</strong> และต่อมาเปลี่ยนเป็น <strong>LTSpice</strong> หากใช้รายการอุปกรณ์ที่มีโมเดลสำหรับ <strong>SPICE</strong> เพื่อการจำลองการทำงาน</li>
<li><a href="https://www.tinkercad.com/learn/circuits"><strong>AUTODESK Tinkercad - Circuits</strong></a> เป็นซอฟต์แวร์ฟรีที่ทำงานในระบบคลาวด์ และสามารถจำลองการทำงานของวงจรไฟฟ้าและอิเล็กทรอนิกส์ได้ เหมาะสำหรับผู้เริ่มต้นและใช้งานผ่านหน้าเว็บเบราว์เซอร์</li>
<li><a href="https://www.tina.com/mixed-circuit-analysis/"><strong>TINA</strong></a> ของบริษัท <a href="https://www.tina.com/"><strong>DesignSoft</strong></a> 
มีเวอร์ชันสำหรับนักศึกษา <a href="https://www.tina.com/tina-student-version/"><strong>Student Version (for Home Use Only)</strong></a> ให้ใช้ได้ฟรี นอกจากนั้นยังมีเวอร์ชันออนไลน์ในระบบคลาวด์ด้วย <a href="https://www.tina.com/tinacloud/"><strong>TINACloud</strong></a><ul>
<li>บริษัท <strong>Infineon</strong> ซึ่งเป็นผู้ผลิตไอซี-อุปกรณ์อิเล็กทรอนิกส์ ได้เปิดให้ผู้ใช้ได้ทดลองใช้ไอซีและวงจรตัวอย่างของทางบริษัทผ่านทางเว็บไซต์ <a href="https://www.infineon.com/cms/en/tools/landing/ifxdesigner.html"><strong>Infineon Designer - Online SPICE Simulator</strong></a> ซึ่งทำงานอยู่บน <strong>TINACloud</strong> เช่นเดียวกับบริษัท <strong>Texas Instruments (TI)</strong> ที่เปิดให้ใช้งาน <a href="https://www.ti.com/tool/TINA-TI"><strong>TINA-TI</strong></a> และอีกตัวเลือกหนึ่งเป็น <a href="https://www.ti.com/tool/PSPICE-FOR-TI"><strong>PSPICE-FOR-TI</strong></a></li>
</ul>
</li>
<li><a href="https://en.wikipedia.org/wiki/Micro-Cap"><strong>Micro-Cap</strong></a> พัฒนาโดยบริษัท <strong>Spectrum Software</strong> มีการใช้งานมาตั้งแต่ราวปีค.ศ. 1982 แต่ในปีค.ศ. 2019 ได้ปิดกิจการไปแล้ว</li>
<li><a href="https://www.labcenter.com/education/"><strong>Proteus Design Suite</strong></a> ของบริษัท <a href="https://www.labcenter.com/"><strong>Labcenter Electronics (UK)</strong></a> เป็นอีกหนึ่งซอฟต์แวร์ที่ใช้ในการจำลองการทำงานของวงจรไฟฟ้าและอิเล็กทรอนิกส์ได้ รวมถึงการออกแบบ <strong>PCB</strong> และจำลองการทำงานโค้ดสำหรับไมโครคอนโทรลเลอร์ได้ด้วย ผู้ใช้จะต้องเสียค่าลิขสิทธิ์สำหรับการใช้งาน (<a href="https://www.labcenter.com/pricing/comm/"><strong>Proteus Licensing &amp; Commercial Prices</strong></a>) แต่มีเวอร์ชันให้ทดลองใช้งาน  (<strong>Demo Version</strong>) ซึ่งมีข้อจำกัดอย่างเช่น ไม่สามารถบันทึกไฟล์ได้</li>
<li><a href="https://www.simetrix.co.uk/products/product-matrix.html"><strong>SIMetrix/SIMPLIS Simulator</strong></a> ของบริษัท <strong>SIMetrix Technologies (UK)</strong> มี <strong>Free Demo Version</strong> ให้ลองใช้งานได้ แต่จำกัดขนาดของวงจรที่สามารถจำลองการทำงานได้</li>
<li><a href="http://ngspice.sourceforge.net/"><strong>Ngspice</strong></a> เป็นซอฟต์แวร์ประเภท <strong>Open Source</strong> แต่ไม่มีส่วนที่เป็น <strong>GUI</strong> และนิยมนำไปใช้ร่วมกับซอฟต์แวร์อื่น โดยให้ทำงานเป็น <strong>Backend</strong>
เช่น เรียกใช้งานในลักษณะที่เป็น <strong>Shared library</strong> หรือ ทำงานในโหมด <strong>Server</strong></li>
<li><a href="https://ra3xdh.github.io/"><strong>Qucs-S</strong></a> เป็นซอฟต์แวร์ประเภท <strong>Open Source</strong> พัฒนาขึ้นเพื่องานวิจัย เขียนด้วยภาษา <strong>C/C++</strong> และใช้ <strong>Qt</strong> สำหรับ <strong>GUI Framework</strong> และใช้ซอฟต์แวร์ เช่น <strong>Ngspice</strong> หรือ <strong>Xyce</strong> เป็น <strong>Simulation backends</strong> </li>
</ul>
<p>ในปัจจุบันซอฟต์แวร์ในกลุ่ม <strong>Circuit Simulation Software</strong> สามารถรองรับการวิเคราะห์วงจรหลายแบบ นอกเหนือจากวงจรแอนะล็อก (<strong>Analog Circuits</strong>) ก็มีวงจรดิจิทัลที่ใช้ไอซีลอจิกต่าง ๆ รวมเรียกว่า (<strong>Mixed-Signal Circuits</strong>) บางซอฟต์แวร์ก็สามารถจำลองการทำงานร่วมกับไมโครคอนโทรลเลอร์ที่มีเฟิร์มแวร์ทำงานได้ไปพร้อม ๆ กัน </p>
<p><strong>ข้อสังเกต:</strong> แม้ว่าซอฟต์แวร์ส่วนใหญ่ตามที่ได้ยกตัวอย่างไป มีพื้นฐานการทำงานมาจาก <strong>SPICE</strong>
และมาพร้อมกับไลบรารีของอุปกรณ์ต่าง ๆ ให้เลือกใช้ในวงจรได้ บริษัทผู้ผลิตไอซีหรืออุปกรณ์อิเล็กทรอนิกส์หลายราย ก็เปิดให้ดาวน์โหลดไฟล์ที่เรียกว่า <strong>SPICE models</strong> ให้นำไปใช้งานได้ แต่การเพิ่มหรือนำเข้าไฟล์ที่เป็นโมเดลของอุปกรณ์เพื่อใช้ในการจำลองการทำงานของคอมโพเนนต์ อาจมีรายละเอียดแตกต่างกันได้ ดังนั้นควรตรวจสอบไฟล์ที่จะนำมาใช้งานว่า เป็นไฟล์แบบใดและเป็น <strong>Generic SPICE / PSPICE-compatible</strong> หรือไม่</p>
<p><img alt="" src="mosfet_spice_models.png" /></p>
<p>รูป: ตัวอย่างหน้าเว็บไซต์ที่มีตัวอย่างไฟล์ <strong>Datasheet PDFs</strong> และ <strong>SPICE Models</strong> 
ให้ดาวน์โหลด เช่น สำหรับทรานซิสเตอร์-มอสเฟต (<strong>MOSFETs</strong>) 
(ที่มา: <a href="https://diodes.com">https://diodes.com</a>)</p>
<p>&nbsp;</p>
<hr />
<h2 id="spice-netlist">&#9655; <strong>SPICE Netlist</strong><a class="headerlink" href="#spice-netlist" title="Permanent link">#</a></h2>
<p>การใช้ซอฟต์แวร์สำหรับการจำลองการทำงานของวงจรโดยทั่วไปแล้ว จะเริ่มต้นด้วยการวาดผังวงจร
(<strong>Schematic Capture</strong> หรือ <strong>Schematic-based Design Entry</strong>)
และใช้งานซอฟต์แวร์ในลักษณะที่เป็นกราฟิกสำหรับผู้ใช้งาน (<strong>GUI</strong>) เมื่อวาดผังวงจรแล้วจะมีการบันทึกไฟล์
ในรูปแบบที่กำหนดไว้ซึ่งอาจแตกต่างกันไปตามซอฟต์แวร์ที่ใช้งาน</p>
<p>ลองมาดูตัวอย่างรูปแบบของไฟล์ที่เรียกว่า <strong>SPICE Netlist</strong> ซึ่งเป็นข้อความ (<strong>Text-based</strong>)
ที่ประกอบด้วยบรรทัดของคำสั่งต่าง ๆ มีการใช้คำสั่งที่เรียกว่า <strong>SPICE Directives</strong>
(คำสั่งที่เริ่มต้นด้วยสัญลักษณ์ <code>.</code> แล้วตามด้วยชื่อคำสั่ง) หรือ เรียกว่า <strong>SPICE Control Statements</strong>
และไฟล์นี้จะมีคำสั่งจบท้ายด้วย <code>.end</code></p>
<p>แต่ถ้าหากเริ่มต้นบรรทัดด้วยสัญลักษณ์ <code>*</code> (<strong>Asterisk</strong>) จะเป็นบรรทัดสำหรับคำอธิบายทั้งบรรทัด
(<strong>Comment Line</strong>) แต่ถ้าเริ่มต้นด้วยสัญลักษณ์ <code>+</code> (<strong>Plus</strong>)
หมายความว่า บรรทัดนี้เป็นข้อความที่ต่อจากบรรทัดก่อนหน้าและเป็นคำสั่งเดียวกัน</p>
<p><img alt="" src="rc_circuit_spice_netlist.png" /></p>
<p>รูป: การวาดผังวงจรที่เรียกว่า <strong>RC Circuit</strong> โดยใช้ <strong>EasyEDA</strong> และตัวอย่าง <strong>SPICE Netlist</strong> ที่เกี่ยวข้อง</p>
<pre><code class="language-text">** A Simple RC Circuit **
VS 1 GND SIN(0 2 50 0 0 0) AC 2 0
R1 1 2 1K
C1 GND 2 1U
.TRAN 0 100MS 0 10US
.PROBE TRAN V(1) V(2) I(R1) I(C1)
.END
</code></pre>
<p>ในไฟล์ <strong>SPICE Netlist</strong> จะต้องมีส่วนที่เรียกว่า <strong>Circuit Topology</strong> ที่ระบุว่า
มีองค์ประกอบของวงจรอะไรบ้าง และเชื่อมต่อกันอย่างไร </p>
<p>วงจรตัวอย่างนี้มีแหล่งจ่ายซึ่งได้มีการอ้างอิงโดยใช้ชื่อ <code>VS</code> และทำหน้าที่สร้างสัญญาณรูปไซน์ (<strong>SIN</strong>) ที่มีแอมพลิจูดแบบ 
<strong>Peak Voltage</strong> เท่ากับ <strong>2V</strong> และมีค่าดีซี-ออฟเซต (<strong>DC Offset</strong>) เท่ากับ <strong>0V</strong>
มีความถี่ (<strong>Frequency</strong>) เท่ากับ <strong>50Hz</strong> และถ้าจะใช้ในการวิเคราะห์วงจรแบบ <strong>AC Analysis</strong>
จะมีค่าแอมพลิจูด (<strong>Amplitude</strong>) เท่ากับ <strong>2V</strong> และมีเฟส (<strong>Phase</strong>) เท่า <strong>0</strong> เรเดียน</p>
<p>ในวงจรมีตัวต้านทานที่ใช้ชื่ออ้างอิง <code>R1</code> และมีค่าความต้านทานเท่ากับ <strong>1k &Omega;</strong>
มีตัวเก็บประจุ <code>C1</code> เท่ากับ <strong>1 uF</strong> และต่ออนุกรมกันกับแหล่งจ่าย <code>VS</code> ให้ครบวงจร</p>
<p>การระบุว่าขาใดบ้างของอุปกรณ์ต่อเข้ากับส่วนอื่นของวงจรอย่างไร จะใช้วิธีระบุชื่อหรือหมายเลขของจุดอ้างอิง
หรือ เรียกว่า "เน็ต" (<strong>Net</strong>) เช่น <code>0</code> หมายถึง <code>GND</code> ของวงจร  ในตัวอย่างนี้ แหล่งจ่าย <code>VS</code>
ต่อกับจุดอ้างอิง <code>1</code>  และ <code>GND</code>ตามลำดับ (หากอุปกรณ์มีขั้ว จะเป็นขั้วบวกและลบตามลำดับ) ตัวต้านทาน <code>R1</code>
มีขาแต่ละหนึ่งต่อกับ <code>1</code>  และ <code>2</code> ตามลำดับ และขาของตัวเก็บประจุ <code>C1</code> ต่อเข้ากับ <code>2</code> และ <code>GND</code> ตามลำดับ</p>
<p>ในส่วนถัดไปเป็นคำสั่งการควบคุมเพื่อโหมดการวิเคราะห์วงจรด้วยการจำลองการทำงาน 
การตั้งค่าและเลือกโหมดในการวิเคราะห์และจำลองการทำงานในตัวอย่างนี้เป็นแบบ <strong>Transient Analysis</strong>
โดยใช้คำสั่ง <code>.tran</code> และระบุว่า ให้เริ่มต้นบันทึกข้อมูลตั้งแต่เวลา <strong>0 sec</strong>
จำลองการทำงานไปจนถึงเวลา <strong>100 msec</strong> (<strong>Stop Time</strong>)
จำลองการทำงานตั้งแต่ <strong>0 sec</strong> (<strong>Start Time</strong>)
และมีระยะเวลาเพิ่มขึ้นครั้งละ <strong>10 usec</strong> (<strong>Step Size</strong>)</p>
<p><img alt="" src="easyeda_settings.png" /></p>
<p>รูป: การตั้งค่าสำหรับแหล่งจ่าย <code>VS</code> และการเลือกโหมดสำหรับการวิเคราะห์วงจร (<code>.trans</code>)
สำหรับ <strong>EasyEDA</strong></p>
<p>ลองเปรียบกับการใช้ซอฟต์แวร์ <strong>NI MultiSim Live</strong> ในการวาดวงจรและจำลองการทำงานดังนี้</p>
<p><img alt="" src="ni_multisim_live-1.png" /></p>
<p>รูป: การวาดผังวงจร <strong>Simple RC Circuit</strong> และเลือกโหมด <strong>Transient Analysis</strong></p>
<p><img alt="" src="ni_multisim_live-2.png" /></p>
<p>รูป: ผลการจำลองการทำงานและแสดงรูปกราฟด้วย <strong>NI MultiSim Live</strong></p>
<p>&nbsp;</p>
<hr />
<h2 id="programming-approaches-to-circuit-simulation">&#9655; <strong>Programming Approaches to Circuit Simulation</strong><a class="headerlink" href="#programming-approaches-to-circuit-simulation" title="Permanent link">#</a></h2>
<p>นอกเหนือจากการใช้ซอฟต์แวร์สำเร็จรูปในการวิเคราะห์หรือจำลองการทำงานของวงจรแล้ว ยังมีอีกแนวทางหนึ่ง
แต่เกี่ยวข้องกับการเขียนโปรแกรมโดยใช้ภาษาคอมพิวเตอร์ เช่น <strong>MATLAB</strong> หรือ <strong>Python</strong>
ผู้ใช้จะต้องเขียนโค้ดเพื่อสร้างวงจร แล้วจำลองการทำงานของวงจรนั้น โดยใช้คำสั่งต่าง ๆ จากไลบรารี หรือ
<strong>API</strong> ที่ได้มีการจัดทำไว้แล้ว</p>
<p>ตัวอย่างโปรเจกต์ที่ใช้ภาษา <strong>Python</strong> สำหรับการวิเคราะห์และจำลองการทำงานของวงจรได้แก่</p>
<ul>
<li><a href="https://github.com/PySpice-org/PySpice"><strong>PySPICE</strong></a><ul>
<li>เป็นโมดูลสำหรับ <strong>Python</strong> ที่ใช้งานร่วมกับ <strong>LTspice Circuit Simulatr</strong>
(เรียกใช้งานแบบ <strong>Shared Library</strong>)</li>
<li>พัฒนาโดย <strong>Fabrice Salvaire</strong> เริ่มต้นเวอร์ชันแรกในปี ค.ศ. 2014 และพัฒนาต่อเนื่องถึงปัจจุบัน</li>
</ul>
</li>
<li><a href="https://github.com/mph-/lcapy"><strong>Lcapy</strong></a><ul>
<li>ใช้โมดูล <strong>SymPy</strong> เป็นพื้นฐานในการทำงาน ดังนั้นจึงเป็นการประมวลผลเชิงสัญลักษณ์และใช้ในการวิเคราะห์วงจรไฟฟ้าที่เป็นเชิงเส้น (<strong>Linear Circuit Analysis</strong>)</li>
<li>พัฒนาโดย <strong>Michael Hayes</strong> ซึ่งเป็นอาจารย์ที่มหาวิทยาลัย <strong>University of Canterbury</strong> ในประเทศนิวซีแลนด์</li>
</ul>
</li>
<li><a href="https://ahkab.github.io/ahkab/"><strong>The Ahkab Project</strong></a> <ul>
<li>เป็นซอฟต์แวร์ประเภท <strong>SPICE-like Electronic Circuit Simulator</strong> โดยใช้ภาษา <strong>Python</strong> เวอร์ชันล่าสุดคือ <strong>v0.18 (released on July 12, 2015)</strong> แต่หลังจากนั้นไม่ได้มีการพัฒนาต่อ </li>
<li>พัฒนามาตั้งแต่ปีค.ศ. 2006 โดย <strong> Giuseppe Venturini</strong>(ต่อมาได้เสียชีวิตลง ทำให้โปรเจกต์นี้หยุดการพัฒนาไป)</li>
</ul>
</li>
<li><a href="https://github.com/giaccone/SpicePy"><strong>SpicePy</strong></a><ul>
<li>ใช้สำหรับการวิเคราะห์วงจรไฟฟ้าที่เป็นเชิงเส้น และใช้วิธีการประมวลผลเชิงตัวเลข  (<strong>NumPy/SciPy</strong>)</li>
<li>พัฒนาโดย <strong>Luca Giaccone</strong> ซึ่งเป็นอาจารย์ที่มหาวิทยาลัย <strong>Politecnico di Torino /  Turin</strong> ประเทศอิตาลี</li>
</ul>
</li>
<li><a href="https://git.ligo.org/sean-leavey/zero/"><strong>The Zero Project</strong></a><ul>
<li>ใช้สำหรับการวิเคราะห์วงจรไฟฟ้าที่เป็นเชิงเส้น และใช้วิธีการประมวลผลเชิงตัวเลข  (<strong>NumPy/SciPy</strong>)</li>
<li>พัฒนาโดย <strong>Sean Leavey</strong></li>
</ul>
</li>
</ul>
<p><img alt="" src="pyspice_demo-1.png" /></p>
<p>รูป: ตัวอย่างการเขียนโค้ด <strong>Python</strong> โดยใช้ <strong>PySPICE</strong> เพื่อจำลองการทำงานของวงจร <strong>RC</strong>
ในโหมด <strong>Transient</strong> และแสดงรูปกราฟ</p>
<p>ในส่วนของภาคปฏิบัติ เช่น การใช้เครื่องมือวัด  <strong>Digital Oscilloscope</strong>, <strong>Function Generator</strong>, <strong>Digital Power Supply</strong> อุปกรณ์เหล่านี้สามารถเชื่อมต่อ <strong>USB</strong> และ <strong>LAN/WiFi</strong> และรองรับการเขียนโปรแกรมควบคุมจากคอมพิวเตอร์ของผู้ใช้ได้ ดังนั้นนอกเหนือจากการกดปุ่มบนแผงควบคุม <strong>Front Panel</strong> ของเครื่องแล้ว ก็ยังสามารถใช้วิธีเขียนโปรแกรมควบคุมได้หลายภาษา เช่น <strong>C#</strong>, <strong>MATLAB</strong> หรือ <strong>Python</strong> เนื่องจากมีการกำหนดโพรโตคอลในการสื่อสารกับอุปกรณ์เครื่องมือวัดที่เป็นมาตรฐาน เช่น <a href="https://en.wikipedia.org/wiki/Virtual_instrument_software_architecture"><strong>VISA</strong></a> (<em>Virtual Instrument Software Architecture</em>) และ <a href="https://www.lxistandard.org/"><strong>LXI</strong></a> (<em>LAN eXtensions for Instrumentation</em>) เป็นต้น หรือใช้ซอฟต์แวร์ควบคุมได้เช่นกัน ยกตัวอย่างเช่น การทำ <strong>DC Sweep</strong> หรือ <strong>AC Sweep</strong> แล้วอ่านข้อมูลที่เป็นผลการทดลองจากเครื่องมือวัด แล้วนำมาสร้างรายงานการทดลองโดยอัตโนมัติ</p>
<p>&nbsp;</p>
<hr />
<h2 id="_1">&#9655; <strong>กล่าวสรุป</strong><a class="headerlink" href="#_1" title="Permanent link">#</a></h2>
<p>บทความนี้นำเสนอเนื้อหาเกี่ยวกับซอฟต์แวร์ที่สามารถนำมาใช้ได้เพื่อการวิเคราะห์และจำลองการทำงานของวงจรไฟฟ้าและอิเล็กทรอนิกส์ ซึ่งมีตัวเลือกอยู่จำนวนมาก และสามารถนำไปใช้สำหรับการเรียนรู้ และฝึกปฏิบัติสำหรับผู้เรียน เพื่อช่วยทำให้เกิดความเข้าใจในเนื้อหาทฤษฏีที่เกี่ยวข้องได้ดีขึ้น</p>
<p>&nbsp;</p>
<hr />
<p><em>This work is licensed under a</em> <strong><em>Creative Commons Attribution-ShareAlike 4.0 International License</em></strong>.</p>
<p>Created: 2022-04-20 | Last Updated: 2022-04-30</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2021-2024 IoT Engineering Education, Bangkok/Thailand</a></p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
